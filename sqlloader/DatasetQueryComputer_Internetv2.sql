INSERT INTO orsdb.computer_internet
(school_year,school_id,com_aca_dnnt_depedbudget,com_aca_dnnt_depednondcp,com_aca_dnnt_lgusef,com_aca_dnnt_ft4,com_aca_dnnt_congress,com_aca_dnnt_frgfund,
com_aca_dnnt_othgov,com_aca_dnnt_privsect,com_aca_dnnt_raff4,total_com_aca_dnnt,com_aca_dvt_depedbudget,com_aca_dvt_depednondcp,com_aca_dvt_lgusef,
com_aca_dvt_ft4,com_aca_dvt_congress,com_aca_dvt_frgfund,com_aca_dvt_othgov,com_aca_dvt_privsect,com_aca_dvt_raff4,total_com_aca_dvt,
aca_desk_dcp,aca_desk_nondcp,aca_desk_lgusef,aca_desk_ft4,aca_desk_othgov,aca_desk_privsect,aca_desk_raff4,total_aca_desk,
aca_note_dcp,aca_note_nondcp,aca_note_lgusef,aca_note_ft4,aca_note_othgov,aca_note_privsect,aca_note_raff4,total_aca_note,
aca_tab_dcp,aca_tab_nondcp,aca_tab_lgusef,aca_tab_ft4,aca_tab_othgov,aca_tab_privsect,aca_tab_raff4,total_aca_tab,com_aca_depedbudget,
com_aca_depednondcp,com_aca_lgusef,com_aca_ft4,com_aca_congress,com_aca_frgfund,com_aca_othgov,com_aca_privsect,com_aca_raff4,
total_com_aca,com_adm_dnnt_depedbudget,com_adm_dnnt_depednondcp,com_adm_dnnt_lgusef,com_adm_dnnt_ft4,com_adm_dnnt_congress,com_adm_dnnt_frgfund,
com_adm_dnnt_othgov,com_adm_dnnt_privsect,com_adm_dnnt_raff4,total_com_adm_dnnt,com_adm_dvt_depedbudget,com_adm_dvt_depednondcp,com_adm_dvt_lgusef,
com_adm_dvt_ft4,com_adm_dvt_congress,com_adm_dvt_frgfund,com_adm_dvt_othgov,com_adm_dvt_privsect,com_adm_dvt_raff4,
total_com_adm_dvt,adm_desk_dcp,adm_desk_nondcp,adm_desk_lgusef,adm_desk_ft4,adm_desk_othgov,adm_desk_privsect,adm_desk_raff4,
total_adm_desk,adm_note_dcp,adm_note_nondcp,adm_note_lgusef,adm_note_ft4,adm_note_othgov,adm_note_privsect,adm_note_raff4,
total_adm_note,adm_tab_dcp,adm_tab_nondcp,adm_tab_lgusef,adm_tab_ft4,adm_tab_othgov,adm_tab_privsect,adm_tab_raff4,total_adm_tab,
com_adm_depedbudget,com_adm_depednondcp,com_adm_lgusef,com_adm_ft4,com_adm_congress,com_adm_frgfund,com_adm_othgov,com_adm_privsect,
com_adm_raff4,total_com_adm,com_rep_dnnt_depedbudget,com_rep_dnnt_lgusef,com_rep_dnnt_ft4,com_rep_dnnt_congress,
com_rep_dnnt_frgfund,com_rep_dnnt_othgov,com_rep_dnnt_privsect,com_rep_dnnt_raff4,total_com_rep_dnnt,com_rep_dvt_depedbudget,
com_rep_dvt_lgusef,com_rep_dvt_ft4,com_rep_dvt_congress,com_rep_dvt_frgfund,com_rep_dvt_othgov,com_rep_dvt_privsect,
com_rep_dvt_raff4,total_com_rep_dvt,com_rep_depedbudget,com_rep_lgusef,com_rep_ft4,com_rep_congress,com_rep_frgfund,com_rep_othgov,
com_rep_privsect,com_rep_raff4,total_com_rep,com_depedbudget,com_depednondcp,com_lgusef,com_ft4,com_congress,com_frgfund,com_othgov,
com_privsect,com_raff4,total_com,int_con_wired_aca,int_con_wired_aca_comp,int_con_wired_aca_virt,int_con_wired_adm,
int_con_wired_adm_comp,int_con_wired_adm_virt,int_con_wired_msf,int_con_wired_band,int_con_wired_cir,int_con_fixed_aca,
int_con_fixed_aca_comp,int_con_fixed_aca_virt,int_con_fixed_adm,int_con_fixed_adm_comp,int_con_fixed_adm_virt,int_con_fixed_msf,
int_con_fixed_band,int_con_fixed_cir,int_con_sate_aca,int_con_sate_aca_comp,int_con_sate_aca_virt,int_con_sate_adm,
int_con_sate_adm_comp,int_con_sate_adm_virt,int_con_sate_msf,int_con_sate_band,int_con_sate_cir,int_con_usb_aca,int_con_usb_aca_comp,
int_con_usb_aca_virt,int_con_usb_adm,int_con_usb_adm_comp,int_con_usb_adm_virt,int_con_usb_msf,int_con_usb_band,int_con_usb_cir,
int_con_wired_depedbudget,int_con_wired_lgusef,int_con_wired_ft4,int_con_wired_congress,int_con_wired_frgfund,int_con_wired_othgov,
int_con_wired_privsect,int_con_wired_raff4,total_int_con_wired,int_con_fixed_depedbudget,int_con_fixed_lgusef,int_con_fixed_ft4,
int_con_fixed_congress,int_con_fixed_frgfund,int_con_fixed_othgov,int_con_fixed_privsect,int_con_fixed_raff4,total_int_con_fixed,
int_con_sate_depedbudget,int_con_sate_lgusef,int_con_sate_ft4,int_con_sate_congress,int_con_sate_frgfund,int_con_sate_othgov,
int_con_sate_privsect,int_con_sate_raff4,total_int_con_sate,int_con_usb_depedbudget,int_con_usb_lgusef,int_con_usb_ft4,
int_con_usb_congress,int_con_usb_frgfund,int_con_usb_othgov,int_con_usb_privsect,int_con_usb_raff4,total_int_con_usb,no_isp,
sch_with_int,isp_smart,isp_globe,isp_pldt,isp_bayantel,isp_digitel,isp_sun,isp_wit,isp_others,isp_use_district,isp_use_division,
isp_use_cafe,isp_use_other_sch,isp_use_home,isp_use_other,avail_net_smart,avail_net_globe,avail_net_sun,avail_net_talkntext,
avail_net_touch,avail_net_red,avail_net_other) 
SELECT
   sph.sy_from as sy_from -- IN smallint(5) unsigned
  ,sph.BEIS_SCHOOL_ID as school_id -- IN int(10) unsigned

-- Computer Academic 2011 - Computers
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=825)),0) as com_aca_dnnt_depedbudget
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=830)),0) as com_aca_dnnt_depednondcp 
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=835)),0) as com_aca_dnnt_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=840)),0) as com_aca_dnnt_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=845)),0) as com_aca_dnnt_congress
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=850)),0) as com_aca_dnnt_frgfund
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=853)),0) as com_aca_dnnt_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=855)),0) as com_aca_dnnt_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=860)),0) as com_aca_dnnt_raff4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538)),0) as total_com_aca_dnnt

-- Computer Academic 2011 - Desktop
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=825)),0) as com_aca_dvt_depedbudget
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=830)),0) as com_aca_dvt_depednondcp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=835)),0) as com_aca_dvt_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=840)),0) as com_aca_dvt_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=845)),0) as com_aca_dvt_congress
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=850)),0) as com_aca_dvt_frgfund
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=853)),0) as com_aca_dvt_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=855)),0) as com_aca_dvt_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=860)),0) as com_aca_dvt_raff4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539)),0) as total_com_aca_dvt

-- Computer Academic 2014 - Desktop
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=627 AND ifs.fund_source_id=825)),0) as aca_desk_dcp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=627 AND ifs.fund_source_id=830)),0) as aca_desk_nondcp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=627 AND ifs.fund_source_id=835)),0) as aca_desk_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=627 AND ifs.fund_source_id=840)),0) as aca_desk_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=627 AND ifs.fund_source_id=853)),0) as aca_desk_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=627 AND ifs.fund_source_id=855)),0) as aca_desk_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=627 AND ifs.fund_source_id=860)),0) as aca_desk_raff4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=627)),0) as total_aca_desk

-- Computer Academic 2014 - Notebook
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=628 AND ifs.fund_source_id=825)),0) as aca_note_dcp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=628 AND ifs.fund_source_id=830)),0) as aca_note_nondcp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=628 AND ifs.fund_source_id=835)),0) as aca_note_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=628 AND ifs.fund_source_id=840)),0) as aca_note_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=628 AND ifs.fund_source_id=853)),0) as aca_note_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=628 AND ifs.fund_source_id=855)),0) as aca_note_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=628 AND ifs.fund_source_id=860)),0) as aca_note_raff4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=628)),0) as total_aca_note

-- Computer Academic 2014 - Tablet
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=631 AND ifs.fund_source_id=825)),0) as aca_tab_dcp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=631 AND ifs.fund_source_id=830)),0) as aca_tab_nondcp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=631 AND ifs.fund_source_id=835)),0) as aca_tab_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=631 AND ifs.fund_source_id=840)),0) as aca_tab_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=631 AND ifs.fund_source_id=853)),0) as aca_tab_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=631 AND ifs.fund_source_id=855)),0) as aca_tab_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=631 AND ifs.fund_source_id=860)),0) as aca_tab_raff4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=631)),0) as total_aca_tab
  
-- Computer Academic - Total Per Fund Source
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (342,538,539,627,628,631) AND ifs.fund_source_id=825)),0) as com_aca_depedbudget
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (342,538,539,627,628,631) AND ifs.fund_source_id=830)),0) as com_aca_depednondcp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (342,538,539,627,628,631) AND ifs.fund_source_id=835)),0) as com_aca_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (342,538,539,627,628,631) AND ifs.fund_source_id=840)),0) as com_aca_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (342,538,539,627,628,631) AND ifs.fund_source_id=845)),0) as com_aca_congress
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (342,538,539,627,628,631) AND ifs.fund_source_id=850)),0) as com_aca_frgfund
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (342,538,539,627,628,631) AND ifs.fund_source_id=853)),0) as com_aca_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (342,538,539,627,628,631) AND ifs.fund_source_id=855)),0) as com_aca_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (342,538,539,627,628,631) AND ifs.fund_source_id=860)),0) as com_aca_raff4

  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (342,538,539,627,628,631))),0) as total_com_aca

-- Computer Administrative 2011 - Computers
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=540 AND ifs.fund_source_id=825)),0) as com_adm_dnnt_depedbudget
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=540 AND ifs.fund_source_id=830)),0) as com_adm_dnnt_depednondcp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=540 AND ifs.fund_source_id=835)),0) as com_adm_dnnt_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=540 AND ifs.fund_source_id=840)),0) as com_adm_dnnt_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=540 AND ifs.fund_source_id=845)),0) as com_adm_dnnt_congress
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=540 AND ifs.fund_source_id=850)),0) as com_adm_dnnt_frgfund
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=540 AND ifs.fund_source_id=853)),0) as com_adm_dnnt_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=540 AND ifs.fund_source_id=855)),0) as com_adm_dnnt_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=540 AND ifs.fund_source_id=860)),0) as com_adm_dnnt_raff4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=540)),0) as total_com_adm_dnnt

-- Computer Administrative 2011 - Desktop
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=541 AND ifs.fund_source_id=825)),0) as com_adm_dvt_depedbudget
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=541 AND ifs.fund_source_id=830)),0) as com_adm_dvt_depednondcp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=541 AND ifs.fund_source_id=835)),0) as com_adm_dvt_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=541 AND ifs.fund_source_id=840)),0) as com_adm_dvt_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=541 AND ifs.fund_source_id=845)),0) as com_adm_dvt_congress
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=541 AND ifs.fund_source_id=850)),0) as com_adm_dvt_frgfund
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=541 AND ifs.fund_source_id=853)),0) as com_adm_dvt_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=541 AND ifs.fund_source_id=855)),0) as com_adm_dvt_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=541 AND ifs.fund_source_id=860)),0) as com_adm_dvt_raff4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=541)),0) as total_com_adm_dvt

-- Computer Administrative 2014 - Desktop
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=632 AND ifs.fund_source_id=825)),0) as adm_desk_dcp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=632 AND ifs.fund_source_id=830)),0) as adm_desk_nondcp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=632 AND ifs.fund_source_id=835)),0) as adm_desk_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=632 AND ifs.fund_source_id=840)),0) as adm_desk_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=632 AND ifs.fund_source_id=853)),0) as adm_desk_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=632 AND ifs.fund_source_id=855)),0) as adm_desk_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=632 AND ifs.fund_source_id=860)),0) as adm_desk_raff4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=632)),0) as total_adm_desk

-- Computer Administrative 2014 - Notebook
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=633 AND ifs.fund_source_id=825)),0) as adm_note_dcp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=633 AND ifs.fund_source_id=830)),0) as adm_note_nondcp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=633 AND ifs.fund_source_id=835)),0) as adm_note_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=633 AND ifs.fund_source_id=840)),0) as adm_note_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=633 AND ifs.fund_source_id=853)),0) as adm_note_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=633 AND ifs.fund_source_id=855)),0) as adm_note_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=633 AND ifs.fund_source_id=860)),0) as adm_note_raff4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=633)),0) as total_adm_note

-- Computer Administrative 2014 - Tablet
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=634 AND ifs.fund_source_id=825)),0) as adm_tab_dcp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=634 AND ifs.fund_source_id=830)),0) as adm_tab_nondcp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=634 AND ifs.fund_source_id=835)),0) as adm_tab_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=634 AND ifs.fund_source_id=840)),0) as adm_tab_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=634 AND ifs.fund_source_id=853)),0) as adm_tab_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=634 AND ifs.fund_source_id=855)),0) as adm_tab_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=634 AND ifs.fund_source_id=860)),0) as adm_tab_raff4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=634)),0) as total_adm_tab

-- Computer Administrative - Total Per Fund Source
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (343,540,541,632,633,634) AND ifs.fund_source_id=825)),0) as com_adm_depedbudget
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (343,540,541,632,633,634) AND ifs.fund_source_id=830)),0) as com_adm_depednondcp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (343,540,541,632,633,634) AND ifs.fund_source_id=835)),0) as com_adm_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (343,540,541,632,633,634) AND ifs.fund_source_id=840)),0) as com_adm_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (343,540,541,632,633,634) AND ifs.fund_source_id=845)),0) as com_adm_congress
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (343,540,541,632,633,634) AND ifs.fund_source_id=850)),0) as com_adm_frgfund
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (343,540,541,632,633,634) AND ifs.fund_source_id=853)),0) as com_adm_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (343,540,541,632,633,634) AND ifs.fund_source_id=855)),0) as com_adm_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (343,540,541,632,633,634) AND ifs.fund_source_id=860)),0) as com_adm_raff4

  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (343,540,541,632,633,634))),0) as total_com_adm

-- Computer Needing Repair 2011 - Computers  
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=542 AND ifs.fund_source_id=825)),0) as com_rep_dnnt_depedbudget
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=542 AND ifs.fund_source_id=835)),0) as com_rep_dnnt_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=542 AND ifs.fund_source_id=840)),0) as com_rep_dnnt_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=542 AND ifs.fund_source_id=845)),0) as com_rep_dnnt_congress
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=542 AND ifs.fund_source_id=850)),0) as com_rep_dnnt_frgfund
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=542 AND ifs.fund_source_id=853)),0) as com_rep_dnnt_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=542 AND ifs.fund_source_id=855)),0) as com_rep_dnnt_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=542 AND ifs.fund_source_id=860)),0) as com_rep_dnnt_raff4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=542)),0) as total_com_rep_dnnt

-- Computer Needing Repair 2011 - Desktop  
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=543 AND ifs.fund_source_id=825)),0) as com_rep_dvt_depedbudget
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=543 AND ifs.fund_source_id=835)),0) as com_rep_dvt_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=543 AND ifs.fund_source_id=840)),0) as com_rep_dvt_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=543 AND ifs.fund_source_id=845)),0) as com_rep_dvt_congress
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=543 AND ifs.fund_source_id=850)),0) as com_rep_dvt_frgfund
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=543 AND ifs.fund_source_id=853)),0) as com_rep_dvt_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=543 AND ifs.fund_source_id=855)),0) as com_rep_dvt_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=543 AND ifs.fund_source_id=860)),0) as com_rep_dvt_raff4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=543)),0) as total_com_rep_dvt

-- Computer Needing Repair - Total Per Fund Source  
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (344,542,543) AND ifs.fund_source_id=825)),0) as com_rep_depedbudget
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (344,542,543) AND ifs.fund_source_id=835)),0) as com_rep_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (344,542,543) AND ifs.fund_source_id=840)),0) as com_rep_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (344,542,543) AND ifs.fund_source_id=845)),0) as com_rep_congress
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (344,542,543) AND ifs.fund_source_id=850)),0) as com_rep_frgfund
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (344,542,543) AND ifs.fund_source_id=853)),0) as com_rep_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (344,542,543) AND ifs.fund_source_id=855)),0) as com_rep_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (344,542,543) AND ifs.fund_source_id=860)),0) as com_rep_raff4

  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (344,542,543))),0) as total_com_rep

-- Computers Total Per Fund Source
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.fund_source_id=825)),0) as com_depedbudget
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.fund_source_id=830)),0) as com_depednondcp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.fund_source_id=835)),0) as com_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.fund_source_id=840)),0) as com_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.fund_source_id=845)),0) as com_congress
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.fund_source_id=850)),0) as com_frgfund
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.fund_source_id=853)),0) as com_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.fund_source_id=855)),0) as com_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.fund_source_id=860)),0) as com_raff4
  
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401)),0) as total_com
  
-- Internet Connectivity - Wired
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=910 AND ic.connection_profile_id=920)),0) as int_con_wired_aca
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=910 AND ic.connection_profile_id=544)),0) as int_con_wired_aca_comp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=910 AND ic.connection_profile_id=545)),0) as int_con_wired_aca_virt
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=910 AND ic.connection_profile_id=922)),0) as int_con_wired_adm
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=910 AND ic.connection_profile_id=546)),0) as int_con_wired_adm_comp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=910 AND ic.connection_profile_id=547)),0) as int_con_wired_adm_virt
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=910 AND ic.connection_profile_id=924)),0) as int_con_wired_msf
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=910 AND ic.connection_profile_id=926)),0) as int_con_wired_band
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=910 AND ic.connection_profile_id=928)),0) as int_con_wired_cir

-- Internet Connectivity - Wireless
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=912 AND ic.connection_profile_id=920)),0) as int_con_fixed_aca
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=912 AND ic.connection_profile_id=544)),0) as int_con_fixed_aca_comp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=912 AND ic.connection_profile_id=545)),0) as int_con_fixed_aca_virt
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=912 AND ic.connection_profile_id=922)),0) as int_con_fixed_adm
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=912 AND ic.connection_profile_id=546)),0) as int_con_fixed_adm_comp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=912 AND ic.connection_profile_id=547)),0) as int_con_fixed_adm_virt
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=912 AND ic.connection_profile_id=924)),0) as int_con_fixed_msf
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=912 AND ic.connection_profile_id=926)),0) as int_con_fixed_band
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=912 AND ic.connection_profile_id=928)),0) as int_con_fixed_cir
  
-- Internet Connectivity - Satellite
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=914 AND ic.connection_profile_id=920)),0) as int_con_sate_aca
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=914 AND ic.connection_profile_id=544)),0) as int_con_sate_aca_comp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=914 AND ic.connection_profile_id=545)),0) as int_con_sate_aca_virt
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=914 AND ic.connection_profile_id=922)),0) as int_con_sate_adm
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=914 AND ic.connection_profile_id=546)),0) as int_con_sate_adm_comp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=914 AND ic.connection_profile_id=547)),0) as int_con_sate_adm_virt
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=914 AND ic.connection_profile_id=924)),0) as int_con_sate_msf
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=914 AND ic.connection_profile_id=926)),0) as int_con_sate_band
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=914 AND ic.connection_profile_id=928)),0) as int_con_sate_cir
  
-- Internet Connectivity - USB Modem
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=916 AND ic.connection_profile_id=920)),0) as int_con_usb_aca
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=916 AND ic.connection_profile_id=544)),0) as int_con_usb_aca_comp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=916 AND ic.connection_profile_id=545)),0) as int_con_usb_aca_virt
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=916 AND ic.connection_profile_id=922)),0) as int_con_usb_adm
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=916 AND ic.connection_profile_id=546)),0) as int_con_usb_adm_comp
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=916 AND ic.connection_profile_id=547)),0) as int_con_usb_adm_virt
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=916 AND ic.connection_profile_id=924)),0) as int_con_usb_msf
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=916 AND ic.connection_profile_id=926)),0) as int_con_usb_band
  ,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM ebeisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=916 AND ic.connection_profile_id=928)),0) as int_con_usb_cir
      
-- Internet Connection By Fund Source - Wired
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=910 AND ifs.fund_source_id=825)),0) as int_con_wired_depedbudget
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=910 AND ifs.fund_source_id=835)),0) as int_con_wired_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=910 AND ifs.fund_source_id=840)),0) as int_con_wired_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=910 AND ifs.fund_source_id=845)),0) as int_con_wired_congress
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=910 AND ifs.fund_source_id=850)),0) as int_con_wired_frgfund
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=910 AND ifs.fund_source_id=853)),0) as int_con_wired_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=910 AND ifs.fund_source_id=855)),0) as int_con_wired_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=910 AND ifs.fund_source_id=860)),0) as int_con_wired_raff4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=910)),0) as total_int_con_wired

-- Internet Connection By Fund Source - Wireless
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=912 AND ifs.fund_source_id=825)),0) as int_con_fixed_depedbudget
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=912 AND ifs.fund_source_id=835)),0) as int_con_fixed_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=912 AND ifs.fund_source_id=840)),0) as int_con_fixed_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=912 AND ifs.fund_source_id=845)),0) as int_con_fixed_congress
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=912 AND ifs.fund_source_id=850)),0) as int_con_fixed_frgfund
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=912 AND ifs.fund_source_id=853)),0) as int_con_fixed_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=912 AND ifs.fund_source_id=855)),0) as int_con_fixed_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=912 AND ifs.fund_source_id=860)),0) as int_con_fixed_raff4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=912)),0) as total_int_con_fixed

-- Internet Connection By Fund Source - Satellite
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=914 AND ifs.fund_source_id=825)),0) as int_con_sate_depedbudget
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=914 AND ifs.fund_source_id=835)),0) as int_con_sate_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=914 AND ifs.fund_source_id=840)),0) as int_con_sate_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=914 AND ifs.fund_source_id=845)),0) as int_con_sate_congress
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=914 AND ifs.fund_source_id=850)),0) as int_con_sate_frgfund
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=914 AND ifs.fund_source_id=853)),0) as int_con_sate_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=914 AND ifs.fund_source_id=855)),0) as int_con_sate_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=914 AND ifs.fund_source_id=860)),0) as int_con_sate_raff4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=914)),0) as total_int_con_sate

-- Internet Connection By Fund Source - USB
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=916 AND ifs.fund_source_id=825)),0) as int_con_usb_depedbudget
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=916 AND ifs.fund_source_id=835)),0) as int_con_usb_lgusef
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=916 AND ifs.fund_source_id=840)),0) as int_con_usb_ft4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=916 AND ifs.fund_source_id=845)),0) as int_con_usb_congress
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=916 AND ifs.fund_source_id=850)),0) as int_con_usb_frgfund
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=916 AND ifs.fund_source_id=853)),0) as int_con_usb_othgov
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=916 AND ifs.fund_source_id=855)),0) as int_con_usb_privsect
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=916 AND ifs.fund_source_id=860)),0) as int_con_usb_raff4
  ,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM ebeisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=916)),0) as total_int_con_usb

-- ISP in the Area
  ,IFNULL(sph.no_isp,1) as no_isp
  ,IF(IFNULL(sph.no_isp,1)=1,0,1) as sch_with_int

-- ISP
  ,IFNULL(osd.isp_smart,0) as isp_smart
  ,IFNULL(osd.isp_globe,0) as isp_globe
  ,IFNULL(osd.isp_pldt,0) as isp_pldt
  ,IFNULL(osd.isp_bayantel,0) as isp_bayantel
  ,IFNULL(osd.isp_digitel,0) as isp_digitel
  ,IFNULL(osd.isp_sun,0) as isp_sun
  ,IFNULL(osd.isp_wit,0) as isp_wit
  ,IFNULL(osd.isp_others,'') as isp_others

-- Internet Outside School
  ,IFNULL(osd.isp_use_district,0) as isp_use_district
  ,IFNULL(osd.isp_use_division,0) as isp_use_division
  ,IFNULL(osd.isp_use_cafe,0) as isp_use_cafe
  ,IFNULL(osd.isp_use_other_sch,0) as isp_use_other_sch
  ,IFNULL(osd.isp_use_home,0) as isp_use_home
  ,IFNULL(osd.isp_use_other,'') as isp_use_other

-- Cellphone Network
  ,IFNULL(osd.available_net_smart,0) as avail_net_smart
  ,IFNULL(osd.available_net_globe,0) as avail_net_globe
  ,IFNULL(osd.available_net_sun,0) as avail_net_sun
  ,IFNULL(osd.available_net_talkntext,0) as avail_net_talkntext
  ,IFNULL(osd.available_net_touch,0) as avail_net_touch
  ,IFNULL(osd.available_net_red,0) as avail_net_red
  ,IFNULL(osd.available_net_other,'') as avail_net_other

FROM ebeisdb.school_profile_history sph
   LEFT JOIN ref_region rr on (rr.id = sph.region_id)
   LEFT JOIN (ebeisdb.report_history rh 
	      inner join ebeisdb.ref_report_history rrh on rh.ref_report_history_id = rrh.id
	      inner join ebeisdb.ref_reports rrs on rrs.id  = rrh.report_id
	      inner join ebeisdb.ref_report_generics rrg on rrg.id = rrs.ref_report_generics_id and rrg.id= if(rh.sy_from=2016,1,2)
	 ) on rh.school_id = sph.school_id and rh.sy_from= sph.sy_from and rh.report_status > 300 -- cast( sph.sy_from as unsigned)
   LEFT JOIN ebeisdb.other_school_data osd on (osd.report_history_id = rh.id)
   WHERE sph.general_classification_id = 7 and sph.take_part_id IN (1,2,3) and sph.sy_from=2016 
   GROUP BY rh.sy_from, sph.SCHOOL_ID 
   ORDER BY sph.SY_FROM, rr.RANK ASC, sph.SCHOOL_ID ASC;

commit;


Internet Connection  2014
insert into orsdb.internet_connection(school_year,school_id,connection_type_id,connection_type,isp_id,isp,funding_source_id,
funding_source,ave_monthly_cost)

SELECT
   sph.sy_from as sy_from -- IN smallint(5) unsigned
  ,sph.BEIS_SCHOOL_ID as school_id -- IN int(10) unsigned
  ,ic.connection_type as connection_type_id
  ,ct.description as connection_type
  ,ic.provider_id as isp_id
  ,isp.description as isp
  ,ic.funding_source as funding_source_id
  ,fs.description as funding_source
  ,ic.ave_monthly_cost as ave_monthly_cost

FROM ebeisdb.school_profile_history sph
   LEFT JOIN ref_region rr on (rr.id = sph.region_id)
   LEFT JOIN (ebeisdb.report_history rh 
	      inner join ebeisdb.ref_report_history rrh on rh.ref_report_history_id = rrh.id
	      inner join ebeisdb.ref_reports rrs on rrs.id  = rrh.report_id
	      inner join ebeisdb.ref_report_generics rrg on rrg.id = rrs.ref_report_generics_id and rrg.id=1
	 ) on rh.school_id = sph.school_id and rh.sy_from= sph.sy_from and rh.report_status > 300 -- cast( sph.sy_from as unsigned)
   LEFT JOIN ebeisdb.internet_connection ic on (ic.report_history_id = rh.id)
   LEFT JOIN ebeisdb.ref_code_setting ct on (ct.id = ic.connection_type)
   LEFT JOIN ebeisdb.ref_code_setting isp on (isp.id = ic.provider_id)
   LEFT JOIN ebeisdb.ref_code_setting fs on (fs.id = ic.funding_source)
   WHERE sph.general_classification_id = 7 and sph.take_part_id IN (1,2,3) and sph.sy_from=2016
   ORDER BY sph.SY_FROM, rr.RANK ASC, sph.SCHOOL_ID ASC;

commit;
