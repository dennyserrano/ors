INSERT INTO `sisdbtest`.`personnel_nonteaching`
(
`sy_from`,
`school_id`,
`vsa3_plantilla`,
`vsa3_actual_male`,
`vsa3_actual_female`,
`vsa3_total_actualmf`,
`vsa3_onleave`,
`vsa3_vacant`,
`vsa3_detailed_office`,
`vsa3_detailed_within`,
`vsa3_detailed_outside`,
`vsa3_detailed_school`,
`vsa3_detailedto_total`,
`vsa3_total_school_plantilla`,
`vsa3_detailed_male`,
`vsa3_detailed_female`,
`vsa3_total_detailed`,
`vsa3_borrowed_male`,
`vsa3_borrowed_female`,
`vsa3_total_borrowed`,
`vsa3_nf_male`,
`vsa3_nf_female`,
`vsa3_total_nf`,
`vsa2_plantilla`,
`vsa2_actual_male`,
`vsa2_actual_female`,
`vsa2_total_actualmf`,
`vsa2_onleave`,
`vsa2_vacant`,
`vsa2_detailed_office`,
`vsa2_detailed_within`,
`vsa2_detailed_outside`,
`vsa2_detailed_school`,
`vsa2_detailedto_total`,
`vsa2_total_school_plantilla`,
`vsa2_detailed_male`,
`vsa2_detailed_female`,
`vsa2_total_detailed`,
`vsa2_borrowed_male`,
`vsa2_borrowed_female`,
`vsa2_total_borrowed`,
`vsa2_nf_male`,
`vsa2_nf_female`,
`vsa2_total_nf`,
`vsa1_plantilla`,
`vsa1_actual_male`,
`vsa1_actual_female`,
`vsa1_total_actualmf`,
`vsa1_onleave`,
`vsa1_vacant`,
`vsa1_detailed_office`,
`vsa1_detailed_within`,
`vsa1_detailed_outside`,
`vsa1_detailed_school`,
`vsa1_detailedto_total`,
`vsa1_total_school_plantilla`,
`vsa1_detailed_male`,
`vsa1_detailed_female`,
`vsa1_total_detailed`,
`vsa1_borrowed_male`,
`vsa1_borrowed_female`,
`vsa1_total_borrowed`,
`vsa1_nf_male`,
`vsa1_nf_female`,
`vsa1_total_nf`,
`vsa_plantilla`,
`vsa_actual_male`,
`vsa_actual_female`,
`vsa_total_actualmf`,
`vsa_onleave`,
`vsa_vacant`,
`vsa_detailed_office`,
`vsa_detailed_within`,
`vsa_detailed_outside`,
`vsa_detailed_school`,
`vsa_detailedto_total`,
`vsa_total_school_plantilla`,
`vsa_detailed_male`,
`vsa_detailed_female`,
`vsa_total_detailed`,
`vsa_borrowed_male`,
`vsa_borrowed_female`,
`vsa_total_borrowed`,
`vsa_nf_male`,
`vsa_nf_female`,
`vsa_total_nf`,
`vsa1_3_plantilla`,
`vsa1_3_actual_male`,
`vsa1_3_actual_female`,
`vsa1_3_total_actualmf`,
`vsa1_3_onleave`,
`vsa1_3_vacant`,
`vsa1_3_detailed_office`,
`vsa1_3_detailed_within`,
`vsa1_3_detailed_outside`,
`vsa1_3_detailed_school`,
`vsa1_3_detailedto_total`,
`vsa1_3_total_school_plantilla`,
`vsa1_3_detailed_male`,
`vsa1_3_detailed_female`,
`vsa1_3_total_detailed`,
`vsa1_3_borrowed_male`,
`vsa1_3_borrowed_female`,
`vsa1_3_total_borrowed`,
`vsa1_3_nf_male`,
`vsa1_3_nf_female`,
`vsa1_3_total_nf`,
`p4_plantilla`,
`p4_actual_male`,
`p4_actual_female`,
`p4_total_actualmf`,
`p4_onleave`,
`p4_vacant`,
`p4_detailed_office`,
`p4_detailed_within`,
`p4_detailed_outside`,
`p4_detailed_school`,
`p4_detailedto_total`,
`p4_total_school_plantilla`,
`p4_detailed_male`,
`p4_detailed_female`,
`p4_total_detailed`,
`p4_borrowed_male`,
`p4_borrowed_female`,
`p4_total_borrowed`,
`p4_nf_male`,
`p4_nf_female`,
`p4_total_nf`,
`p3_plantilla`,
`p3_actual_male`,
`p3_actual_female`,
`p3_total_actualmf`,
`p3_onleave`,
`p3_vacant`,
`p3_detailed_office`,
`p3_detailed_within`,
`p3_detailed_outside`,
`p3_detailed_school`,
`p3_detailedto_total`,
`p3_total_school_plantilla`,
`p3_detailed_male`,
`p3_detailed_female`,
`p3_total_detailed`,
`p3_borrowed_male`,
`p3_borrowed_female`,
`p3_total_borrowed`,
`p3_nf_male`,
`p3_nf_female`,
`p3_total_nf`,
`p2_plantilla`,
`p2_actual_male`,
`p2_actual_female`,
`p2_total_actualmf`,
`p2_onleave`,
`p2_vacant`,
`p2_detailed_office`,
`p2_detailed_within`,
`p2_detailed_outside`,
`p2_detailed_school`,
`p2_detailedto_total`,
`p2_total_school_plantilla`,
`p2_detailed_male`,
`p2_detailed_female`,
`p2_total_detailed`,
`p2_borrowed_male`,
`p2_borrowed_female`,
`p2_total_borrowed`,
`p2_nf_male`,
`p2_nf_female`,
`p2_total_nf`,
`p1_plantilla`,
`p1_actual_male`,
`p1_actual_female`,
`p1_total_actualmf`,
`p1_onleave`,
`p1_vacant`,
`p1_detailed_office`,
`p1_detailed_within`,
`p1_detailed_outside`,
`p1_detailed_school`,
`p1_detailedto_total`,
`p1_total_school_plantilla`,
`p1_detailed_male`,
`p1_detailed_female`,
`p1_total_detailed`,
`p1_borrowed_male`,
`p1_borrowed_female`,
`p1_total_borrowed`,
`p1_nf_male`,
`p1_nf_female`,
`p1_total_nf`,
`p_plantilla`,
`p_actual_male`,
`p_actual_female`,
`p_total_actualmf`,
`p_onleave`,
`p_vacant`,
`p_detailed_office`,
`p_detailed_within`,
`p_detailed_outside`,
`p_detailed_school`,
`p_detailedto_total`,
`p_total_school_plantilla`,
`p_detailed_male`,
`p_detailed_female`,
`p_total_detailed`,
`p_borrowed_male`,
`p_borrowed_female`,
`p_total_borrowed`,
`p_nf_male`,
`p_nf_female`,
`p_total_nf`,
`ht6_plantilla`,
`ht6_actual_male`,
`ht6_actual_female`,
`ht6_total_actualmf`,
`ht6_onleave`,
`ht6_vacant`,
`ht6_detailed_office`,
`ht6_detailed_within`,
`ht6_detailed_outside`,
`ht6_detailed_school`,
`ht6_detailedto_total`,
`ht6_total_school_plantilla`,
`ht6_detailed_male`,
`ht6_detailed_female`,
`ht6_total_detailed`,
`ht6_borrowed_male`,
`ht6_borrowed_female`,
`ht6_total_borrowed`,
`ht6_nf_male`,
`ht6_nf_female`,
`ht6_total_nf`,
`ht5_plantilla`,
`ht5_actual_male`,
`ht5_actual_female`,
`ht5_total_actualmf`,
`ht5_onleave`,
`ht5_vacant`,
`ht5_detailed_office`,
`ht5_detailed_within`,
`ht5_detailed_outside`,
`ht5_detailed_school`,
`ht5_detailedto_total`,
`ht5_total_school_plantilla`,
`ht5_detailed_male`,
`ht5_detailed_female`,
`ht5_total_detailed`,
`ht5_borrowed_male`,
`ht5_borrowed_female`,
`ht5_total_borrowed`,
`ht5_nf_male`,
`ht5_nf_female`,
`ht5_total_nf`,
`ht4_plantilla`,
`ht4_actual_male`,
`ht4_actual_female`,
`ht4_total_actualmf`,
`ht4_onleave`,
`ht4_vacant`,
`ht4_detailed_office`,
`ht4_detailed_within`,
`ht4_detailed_outside`,
`ht4_detailed_school`,
`ht4_detailedto_total`,
`ht4_total_school_plantilla`,
`ht4_detailed_male`,
`ht4_detailed_female`,
`ht4_total_detailed`,
`ht4_borrowed_male`,
`ht4_borrowed_female`,
`ht4_total_borrowed`,
`ht4_nf_male`,
`ht4_nf_female`,
`ht4_total_nf`,
`ht3_plantilla`,
`ht3_actual_male`,
`ht3_actual_female`,
`ht3_total_actualmf`,
`ht3_onleave`,
`ht3_vacant`,
`ht3_detailed_office`,
`ht3_detailed_within`,
`ht3_detailed_outside`,
`ht3_detailed_school`,
`ht3_detailedto_total`,
`ht3_total_school_plantilla`,
`ht3_detailed_male`,
`ht3_detailed_female`,
`ht3_total_detailed`,
`ht3_borrowed_male`,
`ht3_borrowed_female`,
`ht3_total_borrowed`,
`ht3_nf_male`,
`ht3_nf_female`,
`ht3_total_nf`,
`ht2_plantilla`,
`ht2_actual_male`,
`ht2_actual_female`,
`ht2_total_actualmf`,
`ht2_onleave`,
`ht2_vacant`,
`ht2_detailed_office`,
`ht2_detailed_within`,
`ht2_detailed_outside`,
`ht2_detailed_school`,
`ht2_detailedto_total`,
`ht2_total_school_plantilla`,
`ht2_detailed_male`,
`ht2_detailed_female`,
`ht2_total_detailed`,
`ht2_borrowed_male`,
`ht2_borrowed_female`,
`ht2_total_borrowed`,
`ht2_nf_male`,
`ht2_nf_female`,
`ht2_total_nf`,
`ht1_plantilla`,
`ht1_actual_male`,
`ht1_actual_female`,
`ht1_total_actualmf`,
`ht1_onleave`,
`ht1_vacant`,
`ht1_detailed_office`,
`ht1_detailed_within`,
`ht1_detailed_outside`,
`ht1_detailed_school`,
`ht1_detailedto_total`,
`ht1_total_school_plantilla`,
`ht1_detailed_male`,
`ht1_detailed_female`,
`ht1_total_detailed`,
`ht1_borrowed_male`,
`ht1_borrowed_female`,
`ht1_total_borrowed`,
`ht1_nf_male`,
`ht1_nf_female`,
`ht1_total_nf`,
`ht_plantilla`,
`ht_actual_male`,
`ht_actual_female`,
`ht_total_actualmf`,
`ht_onleave`,
`ht_vacant`,
`ht_detailed_office`,
`ht_detailed_within`,
`ht_detailed_outside`,
`ht_detailed_school`,
`ht_detailedto_total`,
`ht_total_school_plantilla`,
`ht_detailed_male`,
`ht_detailed_female`,
`ht_total_detailed`,
`ht_borrowed_male`,
`ht_borrowed_female`,
`ht_total_borrowed`,
`ht_nf_male`,
`ht_nf_female`,
`ht_total_nf`,
`gcoor_plantilla`,
`gcoor_actual_male`,
`gcoor_actual_female`,
`gcoor_total_actualmf`,
`gcoor_onleave`,
`gcoor_vacant`,
`gcoor_detailed_office`,
`gcoor_detailed_within`,
`gcoor_detailed_outside`,
`gcoor_detailed_school`,
`gcoor_detailedto_total`,
`gcoor_total_school_plantilla`,
`gcoor_detailed_male`,
`gcoor_detailed_female`,
`gcoor_total_detailed`,
`gcoor_borrowed_male`,
`gcoor_borrowed_female`,
`gcoor_total_borrowed`,
`gcoor_nf_male`,
`gcoor_nf_female`,
`gcoor_total_nf`,
`gcoun_plantilla`,
`gcoun_actual_male`,
`gcoun_actual_female`,
`gcoun_total_actualmf`,
`gcoun_onleave`,
`gcoun_vacant`,
`gcoun_detailed_office`,
`gcoun_detailed_within`,
`gcoun_detailed_outside`,
`gcoun_detailed_school`,
`gcoun_detailedto_total`,
`gcoun_total_school_plantilla`,
`gcoun_detailed_male`,
`gcoun_detailed_female`,
`gcoun_total_detailed`,
`gcoun_borrowed_male`,
`gcoun_borrowed_female`,
`gcoun_total_borrowed`,
`gcoun_nf_male`,
`gcoun_nf_female`,
`gcoun_total_nf`,
`sb_plantilla`,
`sb_actual_male`,
`sb_actual_female`,
`sb_total_actualmf`,
`sb_onleave`,
`sb_vacant`,
`sb_detailed_office`,
`sb_detailed_within`,
`sb_detailed_outside`,
`sb_detailed_school`,
`sb_detailedto_total`,
`sb_total_school_plantilla`,
`sb_detailed_male`,
`sb_detailed_female`,
`sb_total_detailed`,
`sb_borrowed_male`,
`sb_borrowed_female`,
`sb_total_borrowed`,
`sb_nf_male`,
`sb_nf_female`,
`sb_total_nf`,
`b_plantilla`,
`b_actual_male`,
`b_actual_female`,
`b_total_actualmf`,
`b_onleave`,
`b_vacant`,
`b_detailed_office`,
`b_detailed_within`,
`b_detailed_outside`,
`b_detailed_school`,
`b_detailedto_total`,
`b_total_school_plantilla`,
`b_detailed_male`,
`b_detailed_female`,
`b_total_detailed`,
`b_borrowed_male`,
`b_borrowed_female`,
`b_total_borrowed`,
`b_nf_male`,
`b_nf_female`,
`b_total_nf`,
`do2_plantilla`,
`do2_actual_male`,
`do2_actual_female`,
`do2_total_actualmf`,
`do2_onleave`,
`do2_vacant`,
`do2_detailed_office`,
`do2_detailed_within`,
`do2_detailed_outside`,
`do2_detailed_school`,
`do2_detailedto_total`,
`do2_total_school_plantilla`,
`do2_detailed_male`,
`do2_detailed_female`,
`do2_total_detailed`,
`do2_borrowed_male`,
`do2_borrowed_female`,
`do2_total_borrowed`,
`do2_nf_male`,
`do2_nf_female`,
`do2_total_nf`,
`do1_plantilla`,
`do1_actual_male`,
`do1_actual_female`,
`do1_total_actualmf`,
`do1_onleave`,
`do1_vacant`,
`do1_detailed_office`,
`do1_detailed_within`,
`do1_detailed_outside`,
`do1_detailed_school`,
`do1_detailedto_total`,
`do1_total_school_plantilla`,
`do1_detailed_male`,
`do1_detailed_female`,
`do1_total_detailed`,
`do1_borrowed_male`,
`do1_borrowed_female`,
`do1_total_borrowed`,
`do1_nf_male`,
`do1_nf_female`,
`do1_total_nf`,
`lib_plantilla`,
`lib_actual_male`,
`lib_actual_female`,
`lib_total_actualmf`,
`lib_onleave`,
`lib_vacant`,
`lib_detailed_office`,
`lib_detailed_within`,
`lib_detailed_outside`,
`lib_detailed_school`,
`lib_detailedto_total`,
`lib_total_school_plantilla`,
`lib_detailed_male`,
`lib_detailed_female`,
`lib_total_detailed`,
`lib_borrowed_male`,
`lib_borrowed_female`,
`lib_total_borrowed`,
`lib_nf_male`,
`lib_nf_female`,
`lib_total_nf`,
`overall_plantilla`,
`overall_actual_male`,
`overall_actual_female`,
`overall_total_actualmf`,
`overall_onleave`,
`overall_vacant`,
`overall_detailed_office`,
`overall_detailed_within`,
`overall_detailed_outside`,
`overall_detailed_school`,
`overall_detailedto_total`,
`overall_total_school_plantilla`,
`overall_detailed_male`,
`overall_detailed_female`,
`overall_total_detailed`,
`overall_borrowed_male`,
`overall_borrowed_female`,
`overall_total_borrowed`,
`overall_nf_male`,
`overall_nf_female`,
`overall_total_nf`)

SELECT
sph.sy_from AS SY_FROM,
sph.school_id AS SCHOOL_ID,

SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3total_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3total_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)) as 'vsa3_total_nf',

SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2total_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2total_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)) as 'vsa2_total_nf',


SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1total_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1total_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)) as 'vsa1_total_nf',


SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsatotal_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsatotal_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)) as 'vsa_total_nf',

SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3total_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3total_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)) as 'vsa1_3_total_nf',


SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4total_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 7 and pps.report_history_id = rh.id)) as 'vsa3total_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)) as 'p4_total_nf',

SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3total_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3total_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)) as 'p3_total_nf',


SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2total_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2total_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)) as 'p2_total_nf',


SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1total_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1total_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)) as 'p1_total_nf',

SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'ptotal_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'ptotal_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)) as 'p_total_nf',


SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6total_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6total_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)) as 'ht6_total_nf',

SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5total_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5total_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)) as 'ht5_total_nf',


SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4total_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4total_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)) as 'ht4_total_nf',


SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3total_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3total_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)) as 'ht3_total_nf',

SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2total_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2total_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)) as 'ht2_total_nf',


SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1total_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1total_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)) as 'ht1_total_nf',

SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_total_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_total_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)) as 'ht_total_nf',




SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoortotal_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoortotal_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)) as 'gcoor_total_nf',



SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcountotal_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcountotal_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)) as 'gcoun_total_nf',



SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sbtotal_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sbtotal_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)) as 'sb_total_nf',


SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id= 130 and pps.report_history_id = rh.id)) as 'btotal_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id= 130 and pps.report_history_id = rh.id)) as 'btotal_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)) as 'b_total_nf',


SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2total_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2total_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)) as 'do2_total_nf',



SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1total_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1total_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)) as 'do1_total_nf',



SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id= 25 and pps.report_history_id = rh.id)) as 'libtotal_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id= 25 and pps.report_history_id = rh.id)) as 'libtotal_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)) as 'lib_total_nf',

SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM personnel_position_summary pps WHERE pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_plantilla',
SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_actual_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_actual_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overalltotal_actualmf',
SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_onleave',
SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_vacant',
SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_detailed_office',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_detailed_within',
SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_detailed_outside',
SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_detailed_school',
SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_detailedto_total',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM personnel_position_summary pps WHERE pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overalltotal_school_plantilla',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_detailed_male',
SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_detailed_female',
SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_total_detailed',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_borrowed_male',
SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_borrowed_female',
SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_total_borrowed',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_nf_male',
SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_nf_female',
SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)) as 'overall_total_nf'

FROM school_profile_history sph
LEFT JOIN ref_reports reports on (reports.co_genclass_id=sph.co_gen_class and reports.general_classification_id=sph.general_classification_id AND reports.ref_report_generics_id in (2))
LEFT JOIN ref_report_history rrh on (reports.id=rrh.report_id and rrh.sy_from = CAST(2016 AS CHAR))

LEFT JOIN report_history rh on (rh.ref_report_history_id = rrh.id and rh.school_id=sph.school_id and rh.report_status IN (301,302))
WHERE sph.SY_FROM = 2016 AND sph.general_classification_id = 7 AND sph.co_gen_class in (434) 
AND sph.take_part_id in (2,3) 
AND sph.date_closed is null
GROUP BY sph.SCHOOL_ID
ORDER BY  sph.SCHOOL_ID ASC;
