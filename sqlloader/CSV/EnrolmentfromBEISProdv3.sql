SELECT sph.sy_from, sph.school_id
-- Total Enrolment
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 25, 26))),0) as gkmale_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 25, 26))),0) as gkfemale_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 25, 26))),0) as gk_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 25, 26))),0) as g1male_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 25, 26))),0) as g1female_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 25, 26))),0) as g1_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 25, 26))),0) as g2male_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 25, 26))),0) as g2female_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 25, 26))),0) as g2_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 25, 26))),0) as g3male_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 25, 26))),0) as g3female_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 25, 26))),0) as g3_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 25, 26))),0) as g4male_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 25, 26))),0) as g4female_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 25, 26))),0) as g4_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 25, 26))),0) as g5male_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 25, 26))),0) as g5female_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 25, 26))),0) as g5_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 25, 26))),0) as g6male_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 25, 26))),0) as g6female_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 25, 26))),0) as g6_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 25, 26))),0) as gp7male_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 25, 26))),0) as gp7female_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 25, 26))),0) as gp7_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 25, 26))),0) as g7male_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 25, 26))),0) as g7female_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 25, 26))),0) as g7_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 25, 26))),0) as g8male_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 25, 26))),0) as g8female_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 25, 26))),0) as g8_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 25, 26))),0) as g9male_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 25, 26))),0) as g9female_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 25, 26))),0) as g9_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 25, 26))),0) as g10male_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 25, 26))),0) as g10female_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 25, 26))),0) as g10_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 25, 26))),0) as g11male_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 25, 26))),0) as g11female_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 25, 26))),0) as g11_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 25, 26))),0) as g12male_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 25, 26))),0) as g12female_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 25, 26))),0) as g12_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 25, 26))),0) as gtotmale_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 25, 26))),0) as gtotfemale_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0) + IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 25, 26))),0) as gtot_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 25, 26))),0) as ngmale_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 25, 26))),0) as ngfemale_en
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 25, 26))),0) as ng_en

-- Monograde Enrolment
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 25))),0) as gkmalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 25))),0) as gkfemalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 25))),0) as gktotmono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 25))),0) as g1malemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 25))),0) as g1femalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 25))),0) as g1totmono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 25))),0) as g2malemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 25))),0) as g2femalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 25))),0) as g2totmono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 25))),0) as g3malemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 25))),0) as g3femalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 25))),0) as g3totmono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 25))),0) as g4malemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 25))),0) as g4femalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 25))),0) as g4totmono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 25))),0) as g5malemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 25))),0) as g5femalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 25))),0) as g5totmono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 25))),0) as g6malemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 25))),0) as g6femalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 25))),0) as g6totmono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 25))),0) as gp7malemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 25))),0) as gp7femalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 25))),0) as gp7totmono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 25))),0) as g7malemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 25))),0) as g7femalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 25))),0) as g7totmono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 25))),0) as g8malemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 25))),0) as g8femalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 25))),0) as g8totmono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 25))),0) as g9malemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 25))),0) as g9femalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 25))),0) as g9totmono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 25))),0) as g10malemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 25))),0) as g10femalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 25))),0) as g10totmono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 25))),0) as g11malemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 25))),0) as g11femalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 25))),0) as g11totmono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 25))),0) as g12malemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 25))),0) as g12femalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 25))),0) as g12totmono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 25))),0) as gtotmalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 25))),0) as gtotfemalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0) + IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 25))),0) as gtotmono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 25))),0) as ngmalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 25))),0) as ngfemalemono
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 25))),0) as ngtotmono

-- Multigrade Enrolment
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 26))),0) as gkmalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 26))),0) as gkfemalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 26))),0) as gktotmulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 26))),0) as g1malemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 26))),0) as g1femalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 26))),0) as g1totmulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 26))),0) as g2malemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 26))),0) as g2femalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 26))),0) as g2totmulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 26))),0) as g3malemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 26))),0) as g3femalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 26))),0) as g3totmulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 26))),0) as g4malemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 26))),0) as g4femalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 26))),0) as g4totmulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 26))),0) as g5malemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 26))),0) as g5femalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 26))),0) as g5totmulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 26))),0) as g6malemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 26))),0) as g6femalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 26))),0) as g6totmulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 26))),0) as gp7malemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 26))),0) as gp7femalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 26))),0) as gp7totmulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 26))),0) as g7malemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 26))),0) as g7femalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 26))),0) as g7totmulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 26))),0) as g8malemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 26))),0) as g8femalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 26))),0) as g8totmulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 26))),0) as g9malemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 26))),0) as g9femalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 26))),0) as g9totmulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 26))),0) as g10malemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 26))),0) as g10femalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 26))),0) as g10totmulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 26))),0) as g11malemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 26))),0) as g11femalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 26))),0) as g11totmulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 26))),0) as g12malemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 26))),0) as g12femalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 26))),0) as g12totmulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 26))),0) as gtotmalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 26))),0) as gtotfemalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0) + IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 26))),0) as gtotmulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 26))),0) as ngmalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 26))),0) as ngfemalemulti
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 26))),0) as ngtotmulti

-- Balik-Aral Enrolment
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 312))),0) as gkmaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 312))),0) as gkfemaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 312))),0) as gktotBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 312))),0) as g1maleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 312))),0) as g1femaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 312))),0) as g1totBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 312))),0) as g2maleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 312))),0) as g2femaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 312))),0) as g2totBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 312))),0) as g3maleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 312))),0) as g3femaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 312))),0) as g3totBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 312))),0) as g4maleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 312))),0) as g4femaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 312))),0) as g4totBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 312))),0) as g5maleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 312))),0) as g5femaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 312))),0) as g5totBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 312))),0) as g6maleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 312))),0) as g6femaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 312))),0) as g6totBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 312))),0) as gp7maleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 312))),0) as gp7femaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 312))),0) as gp7totBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 312))),0) as g7maleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 312))),0) as g7femaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 312))),0) as g7totBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 312))),0) as g8maleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 312))),0) as g8femaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 312))),0) as g8totBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 312))),0) as g9maleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 312))),0) as g9femaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 312))),0) as g9totBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 312))),0) as g10maleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 312))),0) as g10femaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 312))),0) as g10totBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 312))),0) as g11maleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 312))),0) as g11femaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 312))),0) as g11totBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 312))),0) as g12maleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 312))),0) as g12femaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 312))),0) as g12totBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 312))),0) as gtotmaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 312))),0) as gtotfemaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0) + IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 312))),0) as gtotBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 312))),0) as ngmaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 312))),0) as ngfemaleBA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 312))),0) as ngtotBA

-- CCT/4Ps Enrolment
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 388))),0) as gkmaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 388))),0) as gkfemaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 388))),0) as gktotCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 388))),0) as g1maleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 388))),0) as g1femaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 388))),0) as g1totCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 388))),0) as g2maleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 388))),0) as g2femaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 388))),0) as g2totCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 388))),0) as g3maleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 388))),0) as g3femaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 388))),0) as g3totCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 388))),0) as g4maleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 388))),0) as g4femaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 388))),0) as g4totCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 388))),0) as g5maleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 388))),0) as g5femaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 388))),0) as g5totCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 388))),0) as g6maleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 388))),0) as g6femaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 388))),0) as g6totCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 388))),0) as gp7maleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 388))),0) as gp7femaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 388))),0) as gp7totCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 388))),0) as g7maleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 388))),0) as g7femaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 388))),0) as g7totCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 388))),0) as g8maleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 388))),0) as g8femaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 388))),0) as g8totCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 388))),0) as g9maleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 388))),0) as g9femaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 388))),0) as g9totCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 388))),0) as g10maleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 388))),0) as g10femaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 388))),0) as g10totCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 388))),0) as g11maleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 388))),0) as g11femaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 388))),0) as g11totCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 388))),0) as g12maleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 388))),0) as g12femaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 388))),0) as g12totCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 388))),0) as gtotmaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 388))),0) as gtotfemaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0) + IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 388))),0) as gtotCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 388))),0) as ngmaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 388))),0) as ngfemaleCCT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 388))),0) as ngtotCCT

-- IP Enrolment
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 315))),0) as gkmaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 315))),0) as gkfemaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 315))),0) as gktotIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 315))),0) as g1maleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 315))),0) as g1femaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 315))),0) as g1totIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 315))),0) as g2maleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 315))),0) as g2femaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 315))),0) as g2totIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 315))),0) as g3maleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 315))),0) as g3femaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 315))),0) as g3totIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 315))),0) as g4maleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 315))),0) as g4femaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 315))),0) as g4totIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 315))),0) as g5maleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 315))),0) as g5femaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 315))),0) as g5totIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 315))),0) as g6maleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 315))),0) as g6femaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 315))),0) as g6totIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 315))),0) as gp7maleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 315))),0) as gp7femaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 315))),0) as gp7totIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 315))),0) as g7maleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 315))),0) as g7femaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 315))),0) as g7totIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 315))),0) as g8maleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 315))),0) as g8femaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 315))),0) as g8totIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 315))),0) as g9maleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 315))),0) as g9femaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 315))),0) as g9totIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 315))),0) as g10maleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 315))),0) as g10femaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 315))),0) as g10totIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 315))),0) as g11maleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 315))),0) as g11femaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 315))),0) as g11totIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 315))),0) as g12maleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 315))),0) as g12femaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 315))),0) as g12totIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 315))),0) as gtotmaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 315))),0) as gtotfemaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0) + IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 315))),0) as gtotIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 315))),0) as ngmaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 315))),0) as ngfemaleIP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 315))),0) as ngtotIP

-- ADM Enrolment
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 386))),0) as gkmaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 386))),0) as gkfemaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 386))),0) as gktotADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 386))),0) as g1maleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 386))),0) as g1femaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 386))),0) as g1totADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 386))),0) as g2maleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 386))),0) as g2femaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 386))),0) as g2totADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 386))),0) as g3maleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 386))),0) as g3femaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 386))),0) as g3totADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 386))),0) as g4maleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 386))),0) as g4femaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 386))),0) as g4totADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 386))),0) as g5maleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 386))),0) as g5femaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 386))),0) as g5totADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 386))),0) as g6maleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 386))),0) as g6femaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 386))),0) as g6totADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 386))),0) as gp7maleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 386))),0) as gp7femaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 386))),0) as gp7totADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 386))),0) as g7maleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 386))),0) as g7femaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 386))),0) as g7totADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 386))),0) as g8maleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 386))),0) as g8femaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 386))),0) as g8totADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 386))),0) as g9maleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 386))),0) as g9femaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 386))),0) as g9totADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 386))),0) as g10maleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 386))),0) as g10femaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 386))),0) as g10totADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 386))),0) as g11maleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 386))),0) as g11femaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 386))),0) as g11totADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 386))),0) as g12maleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 386))),0) as g12femaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 386))),0) as g12totADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 386))),0) as gtotmaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 386))),0) as gtotfemaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0) + IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 386))),0) as gtotADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 386))),0) as ngmaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 386))),0) as ngfemaleADM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 386))),0) as ngtotADM

-- DISTED Enrolment
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 618))),0) as g1maleDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 618))),0) as g1femaleDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 618))),0) as g1totDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 618))),0) as g2maleDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 618))),0) as g2femaleDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 618))),0) as g2totDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 618))),0) as g3maleDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 618))),0) as g3femaleDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 618))),0) as g3totDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 618))),0) as g4maleDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 618))),0) as g4femaleDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 618))),0) as g4totDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 618))),0) as g5maleDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 618))),0) as g5femaleDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 618))),0) as g5totDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 618))),0) as g6maleDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 618))),0) as g6femaleDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 618))),0) as g6totDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 618))),0) as gtotmaleDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 618))),0) as gtotfemaleDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0) + IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 618))),0) as gtotDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 618))),0) as ngmaleDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 618))),0) as ngfemaleDISTED
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 618))),0) as ngtotDISTED

-- E_IMPACT Enrolment
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 616))),0) as gkmaleE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 616))),0) as gkfemaleE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 616))),0) as gktotE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 616))),0) as g1maleE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 616))),0) as g1femaleE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 616))),0) as g1totE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 616))),0) as g2maleE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 616))),0) as g2femaleE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 616))),0) as g2totE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 616))),0) as g3maleE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 616))),0) as g3femaleE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 616))),0) as g3totE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 616))),0) as g4maleE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 616))),0) as g4femaleE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 616))),0) as g4totE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 616))),0) as g5maleE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 616))),0) as g5femaleE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 616))),0) as g5totE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 616))),0) as g6maleE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 616))),0) as g6femaleE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 616))),0) as g6totE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 616))),0) as gtotmaleE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 616))),0) as gtotfemaleE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0) + IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 616))),0) as gtotE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 616))),0) as ngmaleE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 616))),0) as ngfemaleE_IMPACT
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 616))),0) as ngtotE_IMPACT

-- MISOSA Enrolment
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 617))),0) as gkmaleMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 617))),0) as gkfemaleMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 617))),0) as gktotMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 617))),0) as g1maleMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 617))),0) as g1femaleMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 617))),0) as g1totMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 617))),0) as g2maleMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 617))),0) as g2femaleMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 617))),0) as g2totMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 617))),0) as g3maleMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 617))),0) as g3femaleMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 617))),0) as g3totMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 617))),0) as g4maleMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 617))),0) as g4femaleMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 617))),0) as g4totMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 617))),0) as g5maleMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 617))),0) as g5femaleMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 617))),0) as g5totMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 617))),0) as g6maleMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 617))),0) as g6femaleMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 617))),0) as g6totMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 617))),0) as gtotmaleMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 617))),0) as gtotfemaleMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0) + IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 617))),0) as gtotMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 617))),0) as ngmaleMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 617))),0) as ngfemaleMISOSA
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 617))),0) as ngtotMISOSA

-- OTHER SCHOOL INTERVENTION Enrolment
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 619))),0) as gkmaleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 619))),0) as gkfemaleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 619))),0) as gktotOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 619))),0) as g1maleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 619))),0) as g1femaleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 619))),0) as g1totOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 619))),0) as g2maleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 619))),0) as g2femaleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 619))),0) as g2totOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 619))),0) as g3maleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 619))),0) as g3femaleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 619))),0) as g3totOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 619))),0) as g4maleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 619))),0) as g4femaleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 619))),0) as g4totOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 619))),0) as g5maleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 619))),0) as g5femaleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 619))),0) as g5totOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 619))),0) as g6maleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 619))),0) as g6femaleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 619))),0) as g6totOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 626))),0) as g7maleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 626))),0) as g7femaleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 626))),0) as g7totOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 626))),0) as g8maleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 626))),0) as g8femaleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 626))),0) as g8totOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 626))),0) as g9maleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 626))),0) as g9femaleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 626))),0) as g9totOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 626))),0) as g10maleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 626))),0) as g10femaleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 626))),0) as g10totOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 626))),0) as g11maleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 626))),0) as g11femaleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 626))),0) as g11totOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 626))),0) as g12maleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 626))),0) as g12femaleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 626))),0) as g12totOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND if(sph.co_gen_class = 433, en.pupil_data_indicator in ( 619), en.pupil_data_indicator in (626)))),0) as gtotmaleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND if(sph.co_gen_class = 433, en.pupil_data_indicator in ( 619), en.pupil_data_indicator in (626)))),0) as gtotfemaleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0) + IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND if(sph.co_gen_class = 433, en.pupil_data_indicator in ( 619), en.pupil_data_indicator in (626)))),0) as gtotOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND if(sph.co_gen_class = 433, en.pupil_data_indicator in ( 619), en.pupil_data_indicator in (626)))),0) as ngmaleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND if(sph.co_gen_class = 433, en.pupil_data_indicator in ( 619), en.pupil_data_indicator in (626)))),0) as ngfemaleOTHINTERVENTION
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND if(sph.co_gen_class = 433, en.pupil_data_indicator in ( 619), en.pupil_data_indicator in (626)))),0) as ngtotOTHINTERVENTION

-- OHSP Enrolment
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 623))),0) as g7maleOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 623))),0) as g7femaleOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 623))),0) as g7totOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 623))),0) as g8maleOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 623))),0) as g8femaleOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 623))),0) as g8totOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 623))),0) as g9maleOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 623))),0) as g9femaleOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 623))),0) as g9totOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 623))),0) as g10maleOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 623))),0) as g10femaleOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 623))),0) as g10totOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 623))),0) as g11maleOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 623))),0) as g11femaleOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 623))),0) as g11totOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 623))),0) as g12maleOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 623))),0) as g12femaleOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 623))),0) as g12totOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 623))),0) as gtotmaleOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 623))),0) as gtotfemaleOHSP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0) + IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 623))),0) as gtotOHSP
-- Muslim Enrolment
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 313))),0) as gkmaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 313))),0) as gkfemaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 313))),0) as gktotMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 313))),0) as g1maleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 313))),0) as g1femaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 313))),0) as g1totMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 313))),0) as g2maleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 313))),0) as g2femaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 313))),0) as g2totMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 313))),0) as g3maleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 313))),0) as g3femaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 313))),0) as g3totMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 313))),0) as g4maleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 313))),0) as g4femaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 313))),0) as g4totMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 313))),0) as g5maleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 313))),0) as g5femaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 313))),0) as g5totMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 313))),0) as g6maleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 313))),0) as g6femaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 313))),0) as g6totMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 313))),0) as gp7maleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 313))),0) as gp7femaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 313))),0) as gp7totMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 313))),0) as g7maleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 313))),0) as g7femaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 313))),0) as g7totMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 313))),0) as g8maleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 313))),0) as g8femaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 313))),0) as g8totMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 313))),0) as g9maleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 313))),0) as g9femaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 313))),0) as g9totMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 313))),0) as g10maleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 313))),0) as g10femaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 313))),0) as g10totMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 313))),0) as g11maleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 313))),0) as g11femaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 313))),0) as g11totMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 313))),0) as g12maleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 313))),0) as g12femaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 313))),0) as g12totMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 313))),0) as gtotmaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 313))),0) as gtotfemaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0) + IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 313))),0) as gtotMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 313))),0) as ngmaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 313))),0) as ngfemaleMUSLIM
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 313))),0) as ngtotMUSLIM

-- Repeaters Enrolment
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 310))),0) as gkmaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 310))),0) as gkfemaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 310))),0) as gktotREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 310))),0) as g1maleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 310))),0) as g1femaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 310))),0) as g1totREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 310))),0) as g2maleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 310))),0) as g2femaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 310))),0) as g2totREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 310))),0) as g3maleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 310))),0) as g3femaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 310))),0) as g3totREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 310))),0) as g4maleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 310))),0) as g4femaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 310))),0) as g4totREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 310))),0) as g5maleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 310))),0) as g5femaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 310))),0) as g5totREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 310))),0) as g6maleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 310))),0) as g6femaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 310))),0) as g6totREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 310))),0) as gp7maleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 310))),0) as gp7femaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 310))),0) as gp7totREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 310))),0) as g7maleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 310))),0) as g7femaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 310))),0) as g7totREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 310))),0) as g8maleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 310))),0) as g8femaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 310))),0) as g8totREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 310))),0) as g9maleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 310))),0) as g9femaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 310))),0) as g9totREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 310))),0) as g10maleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 310))),0) as g10femaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 310))),0) as g10totREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 310))),0) as g11maleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 310))),0) as g11femaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 310))),0) as g11totREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 310))),0) as g12maleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 310))),0) as g12femaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 310))),0) as g12totREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 310))),0) as gtotmaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 310))),0) as gtotfemaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0) + IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 310))),0) as gtotREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 310))),0) as ngmaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 310))),0) as ngfemaleREP
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 310))),0) as ngtotREP

-- Transfer from Public
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 437))),0) as gkmaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 437))),0) as gkfemaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 405 AND en.pupil_data_indicator in ( 437))),0) as gktotTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 437))),0) as g1maleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 437))),0) as g1femaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 98 AND en.pupil_data_indicator in ( 437))),0) as g1totTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 437))),0) as g2maleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 437))),0) as g2femaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 99 AND en.pupil_data_indicator in ( 437))),0) as g2totTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 437))),0) as g3maleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 437))),0) as g3femaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 100 AND en.pupil_data_indicator in ( 437))),0) as g3totTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 437))),0) as g4maleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 437))),0) as g4femaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 101 AND en.pupil_data_indicator in ( 437))),0) as g4totTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 437))),0) as g5maleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 437))),0) as g5femaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 102 AND en.pupil_data_indicator in ( 437))),0) as g5totTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 437))),0) as g6maleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 437))),0) as g6femaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 103 AND en.pupil_data_indicator in ( 437))),0) as g6totTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 437))),0) as gp7maleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 437))),0) as gp7femaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 104 AND en.pupil_data_indicator in ( 437))),0) as gp7totTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 437))),0) as g7maleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 437))),0) as g7femaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 105 AND en.pupil_data_indicator in ( 437))),0) as g7totTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 437))),0) as g8maleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 437))),0) as g8femaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 106 AND en.pupil_data_indicator in ( 437))),0) as g8totTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 437))),0) as g9maleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 437))),0) as g9femaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 107 AND en.pupil_data_indicator in ( 437))),0) as g9totTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 437))),0) as g10maleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 437))),0) as g10femaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 108 AND en.pupil_data_indicator in ( 437))),0) as g10totTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 437))),0) as g11maleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 437))),0) as g11femaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 497 AND en.pupil_data_indicator in ( 437))),0) as g11totTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 437))),0) as g12maleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 437))),0) as g12femaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = 595 AND en.pupil_data_indicator in ( 437))),0) as g12totTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 437))),0) as gtotmaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 437))),0) as gtotfemaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0) + IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id != if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389)  AND en.pupil_data_indicator in ( 437))),0) as gtotTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 437))),0) as ngmaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 437))),0) as ngfemaleTRPUBLIC
, IFNULL(SUM((SELECT SUM(IFNULL(en.male, 0)+ifnull(en.female,0)) AS sum_en FROM ebeisdb.enrollment_pupil_summary en WHERE en.report_history_id = rh.id AND en.grade_level_id = if(sph.co_gen_class=433, if(sph.sy_from = 2013, 598, 197), 389) AND en.pupil_data_indicator in ( 437))),0) as ngtotTRPUBLIC
FROM ebeisdb.school_profile_history sph
   LEFT JOIN ebeisdb.ref_region rr ON (rr.id=sph.region_id)
   LEFT JOIN (ebeisdb.report_history rh 
	      inner join ebeisdb.ref_report_history rrh on rh.ref_report_history_id = rrh.id
	      inner join ebeisdb.ref_reports rrs on rrs.id  = rrh.report_id
	      inner join ebeisdb.ref_report_generics rrg on rrg.id = rrs.ref_report_generics_id and rrg.id=1
	 ) on rh.school_id = sph.school_id and rh.sy_from= sph.sy_from and rh.report_status >= 297 -- cast( sph.sy_from as unsigned)
   
   WHERE  sph.take_part_id = 1 and sph.sy_from = 2016
   GROUP BY sph.SCHOOL_ID 
   ORDER BY sph.SY_FROM, rr.RANK ASC, sph.SCHOOL_ID ASC

INTO OUTFILE '/var/tmp/enrollment.csv'
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n';


