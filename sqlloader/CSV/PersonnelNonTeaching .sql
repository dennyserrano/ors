SELECT
sph.sy_from AS SY_FROM,
sph.school_id AS SCHOOL_ID,

IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3total_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3total_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 3 and pps.report_history_id = rh.id)),0) as 'vsa3_total_nf',

IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2total_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2total_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 2 and pps.report_history_id = rh.id)),0) as 'vsa2_total_nf',


IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1total_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1total_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 1 and pps.report_history_id = rh.id)),0) as 'vsa1_total_nf',


IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsatotal_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsatotal_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3) and pps.report_history_id = rh.id)),0) as 'vsa_total_nf',

IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3total_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3total_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 127 and pps.report_history_id = rh.id)),0) as 'vsa1_3_total_nf',


IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4total_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'vsa3total_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 7 and pps.report_history_id = rh.id)),0) as 'p4_total_nf',

IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3total_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3total_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 6 and pps.report_history_id = rh.id)),0) as 'p3_total_nf',


IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2total_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2total_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 5 and pps.report_history_id = rh.id)),0) as 'p2_total_nf',


IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1total_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1total_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 4 and pps.report_history_id = rh.id)),0) as 'p1_total_nf',

IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'ptotal_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'ptotal_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (4,5,6,7) and pps.report_history_id = rh.id)),0) as 'p_total_nf',


IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6total_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6total_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 13 and pps.report_history_id = rh.id)),0) as 'ht6_total_nf',

IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5total_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5total_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 12 and pps.report_history_id = rh.id)),0) as 'ht5_total_nf',


IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4total_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4total_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 11 and pps.report_history_id = rh.id)),0) as 'ht4_total_nf',


IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3total_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3total_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 10 and pps.report_history_id = rh.id)),0) as 'ht3_total_nf',

IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2total_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2total_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 9 and pps.report_history_id = rh.id)),0) as 'ht2_total_nf',


IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1total_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1total_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id = 8 and pps.report_history_id = rh.id)),0) as 'ht1_total_nf',

IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_total_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_total_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (8,9,10,11,12,13) and pps.report_history_id = rh.id)),0) as 'ht_total_nf',




IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoortotal_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoortotal_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 129 and pps.report_history_id = rh.id)),0) as 'gcoor_total_nf',



IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcountotal_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcountotal_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 29 and pps.report_history_id = rh.id)),0) as 'gcoun_total_nf',



IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sbtotal_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sbtotal_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 26 and pps.report_history_id = rh.id)),0) as 'sb_total_nf',


IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'btotal_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'btotal_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 130 and pps.report_history_id = rh.id)),0) as 'b_total_nf',


IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2total_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2total_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 28 and pps.report_history_id = rh.id)),0) as 'do2_total_nf',



IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1total_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1total_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 27 and pps.report_history_id = rh.id)),0) as 'do1_total_nf',



IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'libtotal_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'libtotal_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id= 25 and pps.report_history_id = rh.id)),0) as 'lib_total_nf',

IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_items,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_actual_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_actual_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overalltotal_actualmf',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_onleave,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_onleave',
IFNULL(SUM((SELECT SUM(IFNULL(pps.tot_plantilla_vacant,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_vacant',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_admin_teachers,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_detailed_office',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_detailed_within',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_outside_office,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_detailed_outside',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_school,0))  AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_detailed_school',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_detailedto_total',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.tot_onleave,0)+IFNULL(pps.tot_plantilla_vacant,0)+IFNULL(pps.detailed_within_office,0)+IFNULL(pps.detailed_outside_office,0)+IFNULL(pps.detailed_school,0))   AS qty FROM ebeisdb.personnel_position_summary pps WHERE pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overalltotal_school_plantilla',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_detailed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_detailed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_total_detailed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_borrowed_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_borrowed_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.borrowed_male_admin_teacher,0)+IFNULL(pps.borrowed_female_admin_teacher,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_total_borrowed',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.detailed_male,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_nf_male',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_nf_female',
IFNULL(SUM((SELECT SUM(IFNULL(pps.actual_male,0)+IFNULL(pps.actual_female,0)+IFNULL(pps.detailed_male,0)+IFNULL(pps.detailed_female,0)) AS qty FROM ebeisdb.personnel_position_summary pps WHERE  pps.position_id in (1,2,3,127,4,5,6,7,8,9,10,11,12,13,25,26,27,28,29,129,130) and pps.report_history_id = rh.id)),0) as 'overall_total_nf'

FROM ebeisdb.school_profile_history sph
LEFT JOIN ebeisdb.ref_reports reports on (reports.co_genclass_id=sph.co_gen_class 
 and reports.general_classification_id=sph.general_classification_id 
 AND reports.ref_report_generics_id = if(sph.sy_from between 2016 and 2016, 2, 1))
LEFT JOIN ebeisdb.ref_report_history rrh on (reports.id=rrh.report_id and rrh.sy_from = CAST(sph.sy_from AS CHAR))
LEFT JOIN ebeisdb.report_history rh on (rh.ref_report_history_id = rrh.id and rh.school_id=sph.school_id and rh.report_status IN (301,302))
WHERE sph.general_classification_id = 7 AND sph.take_part_id in (1,2,3) AND sph.date_closed is null and sph.sy_from = 2016
GROUP BY sph.sy_from, sph.SCHOOL_ID
ORDER BY sph.sy_from, sph.SCHOOL_ID ASC

INTO OUTFILE '/var/tmp/personnelnonteach.csv'
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n';
