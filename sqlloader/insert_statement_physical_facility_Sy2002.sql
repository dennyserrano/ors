INSERT INTO adi.physical_facility
(sy_from, school_id, com_aca_class, com_sci_lab, com_he_room, com_ia_work, com_pc_room, com_pre_schl, com_sped_class, ins_com_not_used, total_com_ins_room, inc_aca_class, inc_sci_lab, inc_he_room, inc_ia_work, inc_pc_room, inc_pre_schl, inc_sped_class, ins_inc_not_used, total_inc_ins_room, aca_class, sci_lab, he_room, ia_work, pc_room, pre_schl, sped_class, ins_not_used, total_ins_room, non_stan_aca_class, non_stan_sci_lab, non_stan_he_room, non_stan_ia_work, non_stan_pc_room, non_stan_pre_schl, non_stan_sped_class, non_stan_ins_not_used, total_non_stan_ins_room, com_lib, com_cli, com_can, com_ofc, com_oth, com_non_ins_not_used, total_com_non_ins_room, inc_lib, inc_cli, inc_can, inc_ofc, inc_oth, inc_non_ins_not_used, total_inc_non_ins_room, lib, cli, can, ofc, oth, non_ins_not_used, total_non_ins_room, ins_depedbudget, ins_depedfunds, ins_lgusef, ins_ft4, ins_congress, ins_frgfund, ins_others, ins_privsect, ins_raff4, total_ins_funds, oth_ins_depedbudget, oth_ins_depedfunds, oth_ins_lgusef, oth_ins_ft4, oth_ins_congress, oth_ins_frgfund, oth_ins_others, oth_ins_privsect, oth_ins_raff4, total_oth_ins_funds, non_depedbudget, non_depedfunds, non_lgusef, non_ft4, non_congress, non_frgfund, non_others, non_privsect, non_raff4, total_non_ins_funds, total_rooms_funds, ogc_ins_depedbudget, ogc_ins_depedfunds, ogc_ins_lgusef, ogc_ins_ft4, ogc_ins_congress, ogc_ins_frgfund, ogc_ins_others, ogc_ins_privsect, ogc_ins_raff4, total_ogc_ins_funds, ogc_non_depedbudget, ogc_non_depedfunds, ogc_non_lgusef, ogc_non_ft4, ogc_non_congress, ogc_non_frgfund, ogc_non_others, ogc_non_privsect, ogc_non_raff4, total_ogc_non_ins_funds, total_ogc_funds, rep_ins_major, rep_ins_minor, total_ins_rep, rep_non_ins_major, rep_non_ins_minor, total_non_ins_rep, rep_elem_major, rep_elem_minor, total_elem_rep, rep_sec_major, rep_sec_minor, total_sec_rep, rep_kinder_major, rep_kinder_minor, total_kinder_rep, total_need_rep, storey1, storey2, storey3, storey4, makeshift, condemned, condemnable, e_desk, e_chair_achair, k_desk, k_chair_achair, s_desk, s_chair_achair, desk, set_chair_tbl, armchair, pup_girl_toilet, pup_uri_ind, pup_uri_tro, pup_boy_toilet, pup_shared, total_pup_toilet_bowl, per_girl_toilet, per_uri_ind, per_uri_tro, per_boy_toilet, per_shared, total_per_toilet_bowl, total_uri_ind, total_uri_tro, e_girl_toilet, e_uri_ind, e_uri_tro, e_boy_toilet, e_shared, total_elem_toilet_bowl, k_girl_toilet, k_uri_ind, k_uri_tro, k_boy_toilet, k_shared, total_kinder_toilet_bowl, s_girl_toilet, s_uri_ind, s_uri_tro, s_boy_toilet, s_shared, total_sec_toilet_bowl, girl_toilet, uri_ind, uri_tro, boy_toilet, shared, total_toilet_bowl, local_piped, deep_well, rain, nat_source, no_water, water_supply_maynilad, water_supply_manila, water_supply_local, water_supply_coop, water_supply_other, water_monthly_cost, water_fund_sch, water_fund_canteen, water_fund_lgu, water_fund_pta, water_fund_private, water_fund_porkbarrel, water_fund_others, grid, generator, solar, no_elec, grid_supply_meralco, grid_supply_local, grid_supply_others, grid_monthly_cost, grid_fund_sch, grid_fund_canteen, grid_fund_lgu, grid_fund_pta, grid_fund_private, grid_fund_porkbarrel, grid_fund_others, com_aca_depedbudget, com_aca_lgusef, com_aca_ft4, com_aca_congress, com_aca_frgfund, com_aca_others, com_aca_privsect, com_aca_raff4, total_com_aca, com_adm_depedbudget, com_adm_lgusef, com_adm_ft4, com_adm_congress, com_adm_frgfund, com_adm_others, com_adm_privsect, com_adm_raff4, total_com_adm, com_rep_depedbudget, com_rep_lgusef, com_rep_ft4, com_rep_congress, com_rep_frgfund, com_rep_others, com_rep_privsect, com_rep_raff4, total_com_rep, total_com_usage, com_aca_dnnt_depedbudget, com_aca_dnnt_lgusef, com_aca_dnnt_ft4, com_aca_dnnt_congress, com_aca_dnnt_frgfund, com_aca_dnnt_others, com_aca_dnnt_privsect, com_aca_dnnt_raff4, total_com_aca_dnnt, com_aca_dvt_depedbudget, com_aca_dvt_lgusef, com_aca_dvt_ft4, com_aca_dvt_congress, com_aca_dvt_frgfund, com_aca_dvt_others, com_aca_dvt_privsect, com_aca_dvt_raff4, total_com_aca_dvt, com_ada_dnnt_depedbudget, com_ada_dnnt_lgusef, com_ada_dnnt_ft4, com_ada_dnnt_congress, com_ada_dnnt_frgfund, com_ada_dnnt_others, com_ada_dnnt_privsect, com_ada_dnnt_raff4, total_com_ada_dnnt, com_ada_dvt_depedbudget, com_ada_dvt_lgusef, com_ada_dvt_ft4, com_ada_dvt_congress, com_ada_dvt_frgfund, com_ada_dvt_others, com_ada_dvt_privsect, com_ada_dvt_raff4, total_com_ada_dvt, com_rep_dnnt_depedbudget, com_rep_dnnt_lgusef, com_rep_dnnt_ft4, com_rep_dnnt_congress, com_rep_dnnt_frgfund, com_rep_dnnt_others, com_rep_dnnt_privsect, com_rep_dnnt_raff4, total_com_rep_dnnt, com_rep_dvt_depedbudget, com_rep_dvt_lgusef, com_rep_dvt_ft4, com_rep_dvt_congress, com_rep_dvt_frgfund, com_rep_dvt_others, com_rep_dvt_privsect, com_rep_dvt_raff4, total_com_rep_dvt, no_isp, int_con_wired_aca, int_con_wired_adm, int_con_wired_msf, int_con_wired_band, int_con_wired_cir, int_con_fixed_aca, int_con_fixed_adm, int_con_fixed_msf, int_con_fixed_band, int_con_fixed_cir, int_con_sate_aca, int_con_sate_adm, int_con_sate_msf, int_con_sate_band, int_con_sate_cir, int_con_usb_aca, int_con_usb_adm, int_con_usb_msf, int_con_usb_band, int_con_usb_cir, int_con_wired_aca_comp, int_con_wired_aca_virt, int_con_wired_adm_comp, int_con_wired_adm_virt, int_con_fixed_aca_comp, int_con_fixed_aca_virt, int_con_fixed_adm_comp, int_con_fixed_adm_virt, int_con_sate_aca_comp, int_con_sate_aca_virt, int_con_sate_adm_comp, int_con_sate_adm_virt, int_con_usb_aca_comp, int_con_usb_aca_virt, int_con_usb_adm_comp, int_con_usb_adm_virt, int_con_wired_depedbudget, int_con_wired_lgusef, int_con_wired_ft4, int_con_wired_congress, int_con_wired_frgfund, int_con_wired_others, int_con_wired_privsect, int_con_wired_raff4, total_int_con_wired, int_con_fixed_depedbudget, int_con_fixed_lgusef, int_con_fixed_ft4, int_con_fixed_congress, int_con_fixed_frgfund, int_con_fixed_others, int_con_fixed_privsect, int_con_fixed_raff4, total_int_con_fixed, int_con_sate_depedbudget, int_con_sate_lgusef, int_con_sate_ft4, int_con_sate_congress, int_con_sate_frgfund, int_con_sate_others, int_con_sate_privsect, int_con_sate_raff4, total_int_con_sate, int_con_usb_depedbudget, int_con_usb_lgusef, int_con_usb_ft4, int_con_usb_congress, int_con_usb_frgfund, int_con_usb_others, int_con_usb_privsect, int_con_usb_raff4, total_int_con_usb, sch_con_to_isp, isp_smart, isp_globe, isp_pldt, isp_bayantel, isp_digitel, isp_sun, isp_wit, isp_others, isp_use_district, isp_use_division, isp_use_cafe, isp_use_other_sch, isp_use_home, isp_use_other, avail_net_smart, avail_net_globe, avail_net_sun, avail_net_talkntext, avail_net_touch, avail_net_red, avail_net_other) 
SELECT
  sph.sy_from as sy_from -- IN smallint(5) unsigned
  ,sph.BEIS_SCHOOL_ID as school_id -- IN int(10) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=350 AND y.education_level_id=1290)),0),0) as com_aca_class -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=351 AND y.education_level_id=1290)),0),0) as com_sci_lab -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=352 AND y.education_level_id=1290)),0),0) as com_he_room -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=353 AND y.education_level_id=1290)),0),0) as com_ia_work -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=354 AND y.education_level_id=1290)),0),0) as com_pc_room -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=355 AND y.education_level_id=1290)),0),0) as com_pre_schl -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=356 AND y.education_level_id=1290)),0),0) as com_sped_class -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=357 AND y.education_level_id=1290)),0),0) as ins_com_not_used -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id IN (350,351,352,353,354,355,356,357) AND y.education_level_id=1290)),0),0) as total_com_ins_room -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=350 AND y.education_level_id=1291)),0),0) as inc_aca_class -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=351 AND y.education_level_id=1291)),0),0) as inc_sci_lab -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=352 AND y.education_level_id=1291)),0),0) as inc_he_room -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=353 AND y.education_level_id=1291)),0),0) as inc_ia_work -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=354 AND y.education_level_id=1291)),0),0) as inc_pc_room -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=355 AND y.education_level_id=1291)),0),0) as inc_pre_schl -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=356 AND y.education_level_id=1291)),0),0) as inc_sped_class -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=357 AND y.education_level_id=1291)),0),0) as ins_inc_not_used -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id IN (350,351,352,353,354,355,356,357) AND y.education_level_id=1291)),0),0) as total_inc_ins_room -- IN smallint(5) unsigned
  ,IF(sph.sy_from<=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=350)),0),0) as aca_class -- IN smallint(5) unsigned
  ,IF(sph.sy_from<=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=351)),0),0) as sci_lab -- IN smallint(5) unsigned
  ,IF(sph.sy_from<=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=352)),0),0) as he_room -- IN smallint(5) unsigned
  ,IF(sph.sy_from<=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=353)),0),0) as ia_work -- IN smallint(5) unsigned
  ,IF(sph.sy_from<=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=354)),0),0) as pc_room -- IN smallint(5) unsigned
  ,IF(sph.sy_from<=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=355)),0),0) as pre_schl -- IN smallint(5) unsigned
  ,IF(sph.sy_from<=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=356)),0),0) as sped_class -- IN smallint(5) unsigned
  ,IF(sph.sy_from<=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=357)),0),0) as ins_not_used -- IN smallint(5) unsigned
  ,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id IN (350,351,352,353,354,355,356,357))),0) as total_ins_room -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2012,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=350 AND y.education_level_id=589)),0),0) as non_stan_aca_class -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2012,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=351 AND y.education_level_id=589)),0),0) as non_stan_sci_lab -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2012,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=352 AND y.education_level_id=589)),0),0) as non_stan_he_room -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2012,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=353 AND y.education_level_id=589)),0),0) as non_stan_ia_work -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2012,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=354 AND y.education_level_id=589)),0),0) as non_stan_pc_room -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2012,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=355 AND y.education_level_id=589)),0),0) as non_stan_pre_schl -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2012,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=356 AND y.education_level_id=589)),0),0) as non_stan_sped_class -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2012,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=357 AND y.education_level_id=589)),0),0) as non_stan_ins_not_used -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2012,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id IN (350,351,352,353,354,355,356,357) AND y.education_level_id=589)),0),0) as total_non_stan_ins_room -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=358 AND y.education_level_id=1290)),0),0) as com_lib -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=359 AND y.education_level_id=1290)),0),0) as com_cli -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=360 AND y.education_level_id=1290)),0),0) as com_can -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=361 AND y.education_level_id=1290)),0),0) as com_ofc -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=362 AND y.education_level_id=1290)),0),0) as com_oth -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=363 AND y.education_level_id=1290)),0),0) as com_non_ins_not_used -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id IN (358,359,360,361,362,363) AND y.education_level_id=1290)),0),0) as total_com_non_ins_room -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=358 AND y.education_level_id=1291)),0),0) as inc_lib -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=359 AND y.education_level_id=1291)),0),0) as inc_cli -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=360 AND y.education_level_id=1291)),0),0) as inc_can -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=361 AND y.education_level_id=1291)),0),0) as inc_ofc -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=362 AND y.education_level_id=1291)),0),0) as inc_oth -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=363 AND y.education_level_id=1291)),0),0) as inc_non_ins_not_used -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id IN (358,359,360,361,362,363) AND y.education_level_id=1291)),0),0) as total_inc_non_ins_room -- IN smallint(5) unsigned
  ,IF(sph.sy_from<=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=358)),0),0) as lib -- IN smallint(5) unsigned
  ,IF(sph.sy_from<=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=359)),0),0) as cli -- IN smallint(5) unsigned
  ,IF(sph.sy_from<=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=360)),0),0) as can -- IN smallint(5) unsigned
  ,IF(sph.sy_from<=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=361)),0),0) as ofc -- IN smallint(5) unsigned
  ,IF(sph.sy_from<=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=362)),0),0) as oth -- IN smallint(5) unsigned
  ,IF(sph.sy_from<=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=363)),0),0) as non_ins_not_used -- IN smallint(5) unsigned
  ,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id IN (358,359,360,361,362,363))),0) as total_non_ins_room -- IN smallint(5) unsigned
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=338 and yf.fund_source_id=825)),0),0) as ins_depedbudget
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=338 and yf.fund_source_id=830)),0),0) as ins_depedfunds
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=338 and yf.fund_source_id=835)),0),0) as ins_lgusef
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=338 and yf.fund_source_id=840)),0),0) as ins_ft4
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=338 and yf.fund_source_id=845)),0),0) as ins_congress
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=338 and yf.fund_source_id=850)),0),0) as ins_frgfund
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=338 and yf.fund_source_id=853)),0),0) as ins_others
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=338 and yf.fund_source_id=855)),0),0) as ins_privsect
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=338 and yf.fund_source_id=860)),0),0) as ins_raff4
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=338)),0),0) as total_ins_funds
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=340 and yf.fund_source_id=825)),0),0) as oth_ins_depedbudget
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=340 and yf.fund_source_id=830)),0),0) as oth_ins_depedfunds
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=340 and yf.fund_source_id=835)),0),0) as oth_ins_lgusef
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=340 and yf.fund_source_id=840)),0),0) as oth_ins_ft4
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=340 and yf.fund_source_id=845)),0),0) as oth_ins_congress
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=340 and yf.fund_source_id=850)),0),0) as oth_ins_frgfund
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=340 and yf.fund_source_id=853)),0),0) as oth_ins_others
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=340 and yf.fund_source_id=855)),0),0) as oth_ins_privsect
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=340 and yf.fund_source_id=860)),0),0) as oth_ins_raff4
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=340)),0),0) as total_oth_ins_funds
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=339 and yf.fund_source_id=825)),0),0) as non_depedbudget
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=339 and yf.fund_source_id=830)),0),0) as non_depedfunds
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=339 and yf.fund_source_id=835)),0),0) as non_lgusef
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=339 and yf.fund_source_id=840)),0),0) as non_ft4
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=339 and yf.fund_source_id=845)),0),0) as non_congress
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=339 and yf.fund_source_id=850)),0),0) as non_frgfund
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=339 and yf.fund_source_id=853)),0),0) as non_others
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=339 and yf.fund_source_id=855)),0),0) as non_privsect
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=339 and yf.fund_source_id=860)),0),0) as non_raff4
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=339)),0),0) as total_non_ins_funds
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id in (338,339,340))),0),0) as total_rooms_funds
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1295 and yf.fund_source_id=825)),0),0) as ogc_ins_depedbudget
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1295 and yf.fund_source_id=830)),0),0) as ogc_ins_depedfunds
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1295 and yf.fund_source_id=835)),0),0) as ogc_ins_lgusef
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1295 and yf.fund_source_id=840)),0),0) as ogc_ins_ft4
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1295 and yf.fund_source_id=845)),0),0) as ogc_ins_congress
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1295 and yf.fund_source_id=850)),0),0) as ogc_ins_frgfund
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1295 and yf.fund_source_id=853)),0),0) as ogc_ins_others
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1295 and yf.fund_source_id=855)),0),0) as ogc_ins_privsect
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1295 and yf.fund_source_id=860)),0),0) as ogc_ins_raff4
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1295)),0),0) as total_ogc_ins_funds
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1296 and yf.fund_source_id=825)),0),0) as ogc_non_depedbudget
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1296 and yf.fund_source_id=830)),0),0) as ogc_non_depedfunds
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1296 and yf.fund_source_id=835)),0),0) as ogc_non_lgusef
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1296 and yf.fund_source_id=840)),0),0) as ogc_non_ft4
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1296 and yf.fund_source_id=845)),0),0) as ogc_non_congress
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1296 and yf.fund_source_id=850)),0),0) as ogc_non_frgfund
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1296 and yf.fund_source_id=853)),0),0) as ogc_non_others
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1296 and yf.fund_source_id=855)),0),0) as ogc_non_privsect
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1296 and yf.fund_source_id=860)),0),0) as ogc_non_raff4
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id=1296)),0),0) as total_ogc_non_ins_funds
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(yf.qty,0)) FROM sisdb.inventory_fund_source yf WHERE yf.report_history_id=rh.id AND yf.type_of_usage_id in (1296,1295))),0),0) as total_ogc_funds
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=435 and y.item_id=491)),0),0) as rep_kinder_major
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=435 and y.item_id=490)),0),0) as rep_kinder_minor
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=435 and y.item_id in (490,491))),0),0) as total_kinder_rep
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=433 and y.item_id=491)),0),0) as rep_elem_major
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=433 and y.item_id=490)),0),0) as rep_elem_minor
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=433 and y.item_id in (490,491))),0),0) as total_elem_rep
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=434 and y.item_id=491)),0),0) as rep_sec_major
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=434 and y.item_id=490)),0),0) as rep_sec_minor
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=434 and y.item_id in (490,491))),0),0) as total_sec_rep
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=1295 and y.item_id=491)),0),0) as rep_ins_major
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=1295 and y.item_id=490)),0),0) as rep_ins_minor
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=1295 and y.item_id in (490,491))),0),0) as total_rep_ins
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=1296 and y.item_id=491)),0),0) as rep_non_ins_major
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=1296 and y.item_id=490)),0),0) as rep_non_ins_minor
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=1296 and y.item_id in (490,491))),0),0) as total_rep_non_ins
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id in (490,491))),0),0) as total_need_rep
  ,IF(sph.sy_from=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=1331)),0),0) as storey1
  ,IF(sph.sy_from=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=1332)),0),0) as storey2
  ,IF(sph.sy_from=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=1333)),0),0) as storey3
  ,IF(sph.sy_from=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=1334)),0),0) as storey4
  ,IF(sph.sy_from>=2012,IFNULL(SUM((SELECT SUM(IFNULL(o.buildable_space,0)) FROM sisdb.other_school_data o WHERE o.report_history_id=rh.id)),0),0) as buildable_space
  ,IF(sph.sy_from=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=1300)),0),0) as makshift
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=1301)),0),0) as condemned
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=1302)),0),0) as condemnable
  ,IF(sph.sy_from<=2009,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=370)),0),0) as desk
  ,IF(sph.sy_from<=2009,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=371)),0),0) as set_chair_tbl
  ,IF(sph.sy_from<=2009,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=372)),0),0) as armchair
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=433 AND y.item_id=370)),0),0) as e_desk
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=433 AND y.item_id=930)),0),0) as e_chair_achair
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=435 AND y.item_id=370)),0),0) as k_desk
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=435 AND y.item_id=930)),0),0) as k_chair_achair
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=434 AND y.item_id=370)),0),0) as s_desk
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=434 AND y.item_id=930)),0),0) as s_chair_achair
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=1305 AND y.item_id=380)),0),0) as pup_girl_toilet
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=1305 AND y.item_id=381)),0),0) as pup_uri_ind
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=1305 AND y.item_id=382)),0),0) as pup_uri_tro
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=1305 AND y.item_id=383)),0),0) as pup_boy_toilet
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=1305 AND y.item_id=384)),0),0) as pup_shared
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=1305 AND y.item_id in (380,383,384))),0),0) as total_pup_toilet_bowl
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=1306 AND y.item_id=380)),0),0) as per_girl_toilet
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=1306 AND y.item_id=381)),0),0) as per_uri_ind
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=1306 AND y.item_id=382)),0),0) as per_uri_tro
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=1306 AND y.item_id=383)),0),0) as per_boy_toilet
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=1306 AND y.item_id=384)),0),0) as per_shared
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=1306 AND y.item_id in (380,383,384))),0),0) as total_per_toilet_bowl
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=433 AND y.item_id=380)),0),0) as e_girl_toilet
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=433 AND y.item_id=381)),0),0) as e_uri_ind
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=433 AND y.item_id=382)),0),0) as e_uri_tro
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=433 AND y.item_id=383)),0),0) as e_boy_toilet
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=433 AND y.item_id=384)),0),0) as e_shared
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=433 AND y.item_id in (380,383,384))),0),0) as total_e_toilet_bowl
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=435 AND y.item_id=380)),0),0) as k_girl_toilet
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=435 AND y.item_id=381)),0),0) as k_uri_ind
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=435 AND y.item_id=382)),0),0) as k_uri_tro
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=435 AND y.item_id=383)),0),0) as k_boy_toilet
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=435 AND y.item_id=384)),0),0) as k_shared
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=435 AND y.item_id in (380,383,384))),0),0) as total_k_toilet_bowl
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=434 AND y.item_id=380)),0),0) as s_girl_toilet
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=434 AND y.item_id=381)),0),0) as s_uri_ind
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=434 AND y.item_id=382)),0),0) as s_uri_tro
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=434 AND y.item_id=383)),0),0) as s_boy_toilet
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=434 AND y.item_id=384)),0),0) as s_shared
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.education_level_id=434 AND y.item_id in (380,383,384))),0),0) as total_s_toilet_bowl
  ,IF(sph.sy_from<=2009,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=380)),0),0) as girl_toilet
  ,IF(sph.sy_from<=2009,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=381)),0),0) as uri_ind
  ,IF(sph.sy_from<=2009,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=382)),0),0) as uri_tro
  ,IF(sph.sy_from<=2009,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=383)),0),0) as boy_toilet
  ,IF(sph.sy_from<=2009,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=384)),0),0) as shared
  ,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id in (380,383,384))),0) as total_toilet_bowl
  ,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=381)),0) as total_uri_ind
  ,IFNULL(SUM((SELECT SUM(IFNULL(y.quantity,0)) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=382)),0) as total_uri_tro
  ,((SELECT IFNULL(y.quantity,0) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=390)) as local_piped
  ,((SELECT IFNULL(y.quantity,0) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=391)) as deep_well
  ,((SELECT IFNULL(y.quantity,0) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=392)) as rain
  ,((SELECT IFNULL(y.quantity,0) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=393)) as nat_source
  ,((SELECT IFNULL(y.quantity,0) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=394)) as no_water
  ,IFNULL(osd.water_supply_maynilad,0) as water_supply_maynilad
  ,IFNULL(osd.water_supply_manila,0) as water_supply_manila
  ,IFNULL(osd.water_supply_local,0) as water_supply_local
  ,IFNULL(osd.water_supply_coop,0) as water_supply_coop
  ,IFNULL(osd.water_supply_other,'') as water_supply_other
  ,IFNULL(osd.water_monthly_cost,0) as water_monthly_cost
  ,IFNULL(osd.water_fund_sch,0) as water_fund_sch
  ,IFNULL(osd.water_fund_canteen,0) as water_fund_canteen
  ,IFNULL(osd.water_fund_lgu,0) as water_fund_lgu
  ,IFNULL(osd.water_fund_pta,0) as water_fund_pta
  ,IFNULL(osd.water_fund_private,0) as water_fund_private
  ,IFNULL(osd.water_fund_porkbarrel,0) as water_fund_porkbarrel
  ,IFNULL(osd.water_fund_others,'') as water_fund_others
  ,((SELECT IFNULL(y.quantity,0) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=395)) as grid
  ,((SELECT IFNULL(y.quantity,0) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=396)) as generator
  ,((SELECT IFNULL(y.quantity,0) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=397)) as solar
  ,((SELECT IFNULL(y.quantity,0) FROM sisdb.inventory_summary y WHERE y.report_history_id=rh.id AND y.item_id=398)) as no_elec
  ,IFNULL(osd.grid_supply_meralco,0) as grid_supply_meralco
  ,IFNULL(osd.grid_supply_local,0) as grid_supply_local
  ,IFNULL(osd.grid_supply_others,0) as grid_supply_others
  ,IFNULL(osd.grid_monthly_cost,0) as grid_monthly_cost
  ,IFNULL(osd.grid_fund_sch,0) as grid_fund_sch
  ,IFNULL(osd.grid_fund_canteen,0) as grid_fund_canteen
  ,IFNULL(osd.grid_fund_lgu,0) as grid_fund_lgu
  ,IFNULL(osd.grid_fund_pta,0) as grid_fund_pta
  ,IFNULL(osd.grid_fund_private,0) as grid_fund_private
  ,IFNULL(osd.grid_fund_porkbarrel,0) as grid_fund_porkbarrel
  ,IFNULL(osd.grid_fund_others,'') as grid_fund_others
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=342 AND ifs.fund_source_id=825)),0),0) as com_aca_depedbudget
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=342 AND ifs.fund_source_id=835)),0),0) as com_aca_lgusef
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=342 AND ifs.fund_source_id=840)),0),0) as com_aca_ft4
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=342 AND ifs.fund_source_id=845)),0),0) as com_aca_congress
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=342 AND ifs.fund_source_id=850)),0),0) as com_aca_frgfund
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=342 AND ifs.fund_source_id=853)),0),0) as com_aca_others
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=342 AND ifs.fund_source_id=855)),0),0) as com_aca_privsect
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=342 AND ifs.fund_source_id=860)),0),0) as com_aca_raff4
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (342,538))),0),0) as total_com_aca
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=343 AND ifs.fund_source_id=825)),0),0) as com_adm_depedbudget
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=343 AND ifs.fund_source_id=835)),0),0) as com_adm_lgusef
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=343 AND ifs.fund_source_id=840)),0),0) as com_adm_ft4
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=343 AND ifs.fund_source_id=845)),0),0) as com_adm_congress
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=343 AND ifs.fund_source_id=850)),0),0) as com_adm_frgfund
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=343 AND ifs.fund_source_id=853)),0),0) as com_adm_others
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=343 AND ifs.fund_source_id=855)),0),0) as com_adm_privsect
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=343 AND ifs.fund_source_id=860)),0),0) as com_adm_raff4
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (343,539))),0),0) as total_com_adm
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=344 AND ifs.fund_source_id=825)),0),0) as com_rep_depedbudget
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=344 AND ifs.fund_source_id=835)),0),0) as com_rep_lgusef
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=344 AND ifs.fund_source_id=840)),0),0) as com_rep_ft4
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=344 AND ifs.fund_source_id=845)),0),0) as com_rep_congress
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=344 AND ifs.fund_source_id=850)),0),0) as com_rep_frgfund
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=344 AND ifs.fund_source_id=853)),0),0) as com_rep_others
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=344 AND ifs.fund_source_id=855)),0),0) as com_rep_privsect
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=344 AND ifs.fund_source_id=860)),0),0) as com_rep_raff4
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id in (344,540))),0),0) as total_com_rep
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=825)),0),0) as com_aca_dnnt_depedbudget
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=835)),0),0) as com_aca_dnnt_lgusef
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=840)),0),0) as com_aca_dnnt_ft4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=845)),0),0) as com_aca_dnnt_congress
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=850)),0),0) as com_aca_dnnt_frgfund
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=853)),0),0) as com_aca_dnnt_others
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=855)),0),0) as com_aca_dnnt_privsect
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=860)),0),0) as com_aca_dnnt_raff4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538)),0),0) as total_com_aca_dnnt
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=825)),0),0) as com_aca_dvt_depedbudget
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=835)),0),0) as com_aca_dvt_lgusef
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=840)),0),0) as com_aca_dvt_ft4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=845)),0),0) as com_aca_dvt_congress
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=850)),0),0) as com_aca_dvt_frgfund
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=853)),0),0) as com_aca_dvt_others
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=855)),0),0) as com_aca_dvt_privsect
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=860)),0),0) as com_aca_dvt_raff4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539)),0),0) as total_com_aca_dvt
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=825)),0),0) as com_adm_dnnt_depedbudget
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=835)),0),0) as com_adm_dnnt_lgusef
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=840)),0),0) as com_adm_dnnt_ft4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=845)),0),0) as com_adm_dnnt_congress
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=850)),0),0) as com_adm_dnnt_frgfund
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=853)),0),0) as com_adm_dnnt_others
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=855)),0),0) as com_adm_dnnt_privsect
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=860)),0),0) as com_adm_dnnt_raff4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538)),0),0) as total_com_adm_dnnt
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=825)),0),0) as com_adm_dvt_depedbudget
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=835)),0),0) as com_adm_dvt_lgusef
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=840)),0),0) as com_adm_dvt_ft4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=845)),0),0) as com_adm_dvt_congress
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=850)),0),0) as com_adm_dvt_frgfund
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=853)),0),0) as com_adm_dvt_others
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=855)),0),0) as com_adm_dvt_privsect
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=860)),0),0) as com_adm_dvt_raff4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539)),0),0) as total_com_adm_dvt
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=825)),0),0) as com_rep_dnnt_depedbudget
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=835)),0),0) as com_rep_dnnt_lgusef
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=840)),0),0) as com_rep_dnnt_ft4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=845)),0),0) as com_rep_dnnt_congress
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=850)),0),0) as com_rep_dnnt_frgfund
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=853)),0),0) as com_rep_dnnt_others
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=855)),0),0) as com_rep_dnnt_privsect
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538 AND ifs.fund_source_id=860)),0),0) as com_rep_dnnt_raff4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=538)),0),0) as total_com_rep_dnnt
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=825)),0),0) as com_rep_dvt_depedbudget
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=835)),0),0) as com_rep_dvt_lgusef
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=840)),0),0) as com_rep_dvt_ft4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=845)),0),0) as com_rep_dvt_congress
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=850)),0),0) as com_rep_dvt_frgfund
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=853)),0),0) as com_rep_dvt_others
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=855)),0),0) as com_rep_dvt_privsect
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539 AND ifs.fund_source_id=860)),0),0) as com_rep_dvt_raff4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.category_id=401 AND ifs.type_of_usage_id=539)),0),0) as total_com_rep_dvt
  ,IF(sph.sy_from=2010,IFNULL(sph.no_isp,1),1) as no_isp
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=910 AND ic.connection_profile_id=920)),0),0) as int_con_wired_aca
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=910 AND ic.connection_profile_id=922)),0),0) as int_con_wired_adm
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=910 AND ic.connection_profile_id=924)),0),0) as int_con_wired_msf
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=910 AND ic.connection_profile_id=926)),0),0) as int_con_wired_band
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=910 AND ic.connection_profile_id=928)),0),0) as int_con_wired_cir
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=912 AND ic.connection_profile_id=920)),0),0) as int_con_fixed_aca
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=912 AND ic.connection_profile_id=922)),0),0) as int_con_fixed_adm
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=912 AND ic.connection_profile_id=924)),0),0) as int_con_fixed_msf
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=912 AND ic.connection_profile_id=926)),0),0) as int_con_fixed_band
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=912 AND ic.connection_profile_id=928)),0),0) as int_con_fixed_cir
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=914 AND ic.connection_profile_id=920)),0),0) as int_con_sate_aca
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=914 AND ic.connection_profile_id=922)),0),0) as int_con_sate_adm
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=914 AND ic.connection_profile_id=924)),0),0) as int_con_sate_msf
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=914 AND ic.connection_profile_id=926)),0),0) as int_con_sate_band
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=914 AND ic.connection_profile_id=928)),0),0) as int_con_sate_cir
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=916 AND ic.connection_profile_id=920)),0),0) as int_con_usb_aca
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=916 AND ic.connection_profile_id=922)),0),0) as int_con_usb_adm
  ,IF(sph.sy_from=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=916 AND ic.connection_profile_id=924)),0),0) as int_con_usb_msf
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=916 AND ic.connection_profile_id=926)),0),0) as int_con_usb_band
  ,IF(sph.sy_from>=2010,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=916 AND ic.connection_profile_id=928)),0),0) as int_con_usb_cir
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=910 AND ic.connection_profile_id=544)),0),0) as int_con_wired_aca_comp
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=910 AND ic.connection_profile_id=545)),0),0) as int_con_wired_aca_virt
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=910 AND ic.connection_profile_id=546)),0),0) as int_con_wired_adm_comp
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=910 AND ic.connection_profile_id=547)),0),0) as int_con_wired_adm_virt
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=912 AND ic.connection_profile_id=544)),0),0) as int_con_fixed_aca_comp
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=912 AND ic.connection_profile_id=545)),0),0) as int_con_fixed_aca_virt
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=912 AND ic.connection_profile_id=546)),0),0) as int_con_fixed_adm_comp
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=912 AND ic.connection_profile_id=547)),0),0) as int_con_fixed_adm_virt
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=914 AND ic.connection_profile_id=544)),0),0) as int_con_sate_aca_comp
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=914 AND ic.connection_profile_id=545)),0),0) as int_con_sate_aca_virt
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=914 AND ic.connection_profile_id=546)),0),0) as int_con_sate_adm_comp
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=914 AND ic.connection_profile_id=547)),0),0) as int_con_sate_adm_virt
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=916 AND ic.connection_profile_id=544)),0),0) as int_con_usb_aca_comp
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=916 AND ic.connection_profile_id=545)),0),0) as int_con_usb_aca_virt
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=916 AND ic.connection_profile_id=546)),0),0) as int_con_usb_adm_comp
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ic.connection_figure,0)) FROM sisdb.internet_connectivity ic WHERE ic.report_history_id=rh.id AND ic.connection_type_id=916 AND ic.connection_profile_id=547)),0),0) as int_con_usb_adm_virt
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=910 AND ifs.fund_source_id=825)),0),0) as int_con_wired_depedbudget
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=910 AND ifs.fund_source_id=835)),0),0) as int_con_wired_lgusef
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=910 AND ifs.fund_source_id=840)),0),0) as int_con_wired_ft4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=910 AND ifs.fund_source_id=845)),0),0) as int_con_wired_congress
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=910 AND ifs.fund_source_id=850)),0),0) as int_con_wired_frgfund
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=910 AND ifs.fund_source_id=853)),0),0) as int_con_wired_others
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=910 AND ifs.fund_source_id=855)),0),0) as int_con_wired_privsect
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=910 AND ifs.fund_source_id=860)),0),0) as int_con_wired_raff4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=910)),0),0) as total_int_con_wired
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=912 AND ifs.fund_source_id=825)),0),0) as int_con_fixed_depedbudget
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=912 AND ifs.fund_source_id=835)),0),0) as int_con_fixed_lgusef
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=912 AND ifs.fund_source_id=840)),0),0) as int_con_fixed_ft4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=912 AND ifs.fund_source_id=845)),0),0) as int_con_fixed_congress
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=912 AND ifs.fund_source_id=850)),0),0) as int_con_fixed_frgfund
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=912 AND ifs.fund_source_id=853)),0),0) as int_con_fixed_others
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=912 AND ifs.fund_source_id=855)),0),0) as int_con_fixed_privsect
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=912 AND ifs.fund_source_id=860)),0),0) as int_con_fixed_raff4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=912)),0),0) as total_int_con_fixed
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=914 AND ifs.fund_source_id=825)),0),0) as int_con_sate_depedbudget
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=914 AND ifs.fund_source_id=835)),0),0) as int_con_sate_lgusef
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=914 AND ifs.fund_source_id=840)),0),0) as int_con_sate_ft4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=914 AND ifs.fund_source_id=845)),0),0) as int_con_sate_congress
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=914 AND ifs.fund_source_id=850)),0),0) as int_con_sate_frgfund
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=914 AND ifs.fund_source_id=853)),0),0) as int_con_sate_others
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=914 AND ifs.fund_source_id=855)),0),0) as int_con_sate_privsect
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=914 AND ifs.fund_source_id=860)),0),0) as int_con_sate_raff4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=914)),0),0) as total_int_con_sate
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=916 AND ifs.fund_source_id=825)),0),0) as int_con_usb_depedbudget
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=916 AND ifs.fund_source_id=835)),0),0) as int_con_usb_lgusef
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=916 AND ifs.fund_source_id=840)),0),0) as int_con_usb_ft4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=916 AND ifs.fund_source_id=845)),0),0) as int_con_usb_congress
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=916 AND ifs.fund_source_id=850)),0),0) as int_con_usb_frgfund
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=916 AND ifs.fund_source_id=853)),0),0) as int_con_usb_others
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=916 AND ifs.fund_source_id=855)),0),0) as int_con_usb_privsect
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=916 AND ifs.fund_source_id=860)),0),0) as int_con_usb_raff4
  ,IF(sph.sy_from>=2011,IFNULL(SUM((SELECT SUM(IFNULL(ifs.qty,0)) FROM sisdb.inventory_fund_source ifs WHERE ifs.report_history_id=rh.id AND ifs.type_of_usage_id=916)),0),0) as total_int_con_usb
  ,IF(sph.sy_from>=2011,IF(IFNULL(sph.no_isp,1)=1,0,1),0) as sch_con_to_isp
  ,IFNULL(osd.isp_smart,0) as isp_smart
  ,IFNULL(osd.isp_globe,0) as isp_globe
  ,IFNULL(osd.isp_pldt,0) as isp_pldt
  ,IFNULL(osd.isp_bayantel,0) as isp_bayantel
  ,IFNULL(osd.isp_digitel,0) as isp_digitel
  ,IFNULL(osd.isp_sun,0) as isp_sun
  ,IFNULL(osd.isp_wit,0) as isp_wit
  ,IFNULL(osd.isp_others,'') as isp_others
  ,IFNULL(osd.isp_use_district,0) as isp_use_district
  ,IFNULL(osd.isp_use_division,0) as isp_use_division
  ,IFNULL(osd.isp_use_cafe,0) as isp_use_cafe
  ,IFNULL(osd.isp_use_other_sch,0) as isp_use_other_sch
  ,IFNULL(osd.isp_use_home,0) as isp_use_home
  ,IFNULL(osd.isp_use_other,'') as isp_use_other
  ,IFNULL(osd.available_net_smart,0) as avail_net_smart
  ,IFNULL(osd.available_net_globe,0) as avail_net_globe
  ,IFNULL(osd.available_net_sun,0) as avail_net_sun
  ,IFNULL(osd.available_net_talkntext,0) as avail_net_talkntext
  ,IFNULL(osd.available_net_touch,0) as avail_net_touch
  ,IFNULL(osd.available_net_red,0) as avail_net_red
  ,IFNULL(osd.available_net_other,'') as avail_net_other
FROM sisdb.school_profile_history sph
INNER JOIN sisdb.ref_reports reports on (reports.co_genclass_id=sph.co_gen_class and reports.general_classification_id=sph.general_classification_id and reports.ref_report_generics_id=if(sph.sy_from<=2009,1,2))
INNER JOIN sisdb.ref_report_history rrh on (reports.id=rrh.report_id and rrh.sy_from=CAST(sph.sy_from AS CHAR))
LEFT JOIN sisdb.report_history rh on (rh.ref_report_history_id=rrh.id and rh.school_id=sph.school_id and rh.report_status IN (301,302))
LEFT JOIN sisdb.other_school_data osd on (osd.report_history_id=rh.id)
WHERE sph.general_classification_id=7
-- and sph.co_gen_class=433
-- and sph.division_id=55
and sph.sy_from=2002
-- and sph.school_id=121883
 GROUP BY sph.BEIS_SCHOOL_ID -- with rollup;
 ORDER BY sph.BEIS_SCHOOL_ID;