INSERT INTO orsdb.shs_enrollment_first_sem(
`sy_from` ,
  `school_id`,
  `g11maleACAD_EN` ,
  `g11femaleACAD_EN` ,
  `g11ACAD_TOT_EN` ,
  `g11maleACAD_BA` ,
  `g11femaleACAD_BA` ,
  `g11ACAD_TOT_BA` ,
  `g11maleACAD_CCT` ,
  `g11femaleACAD_CCT` ,
  `g11ACAD_TOT_CCT` ,
  `g11maleACAD_IP` ,
  `g11femaleACAD_IP` ,
  `g11ACAD_TOT_IP` ,
  `g11maleACAD_MUSLIM` ,
  `g11femaleACAD_MUSLIM` ,
  `g11ACAD_TOT_MUSLIM` ,
  `g11maleACAD_REP` ,
  `g11femaleACAD_REP` ,
  `g11ACAD_TOT_REP` ,
  `g11maleACAD_TRPUBLIC` ,
  `g11femaleACAD_TRPUBLIC` ,
  `g11ACAD_TOT_TRPUBLIC` ,
  `g11maleACAD_TRPRIVATE` ,
  `g11femaleACAD_TRPRIVATE` ,
  `g11ACAD_TOT_TRPRIVATE` ,
  `g11_ACAD_TOT_CLASS` ,
  `g11maleARTS_EN` ,
  `g11femaleARTS_EN` ,
  `g11ARTS_TOT_EN` ,
  `g11maleARTS_BA` ,
  `g11femaleARTS_BA` ,
  `g11ARTS_TOT_BA` ,
  `g11maleARTS_CCT` ,
  `g11femaleARTS_CCT` ,
  `g11ARTS_TOT_CCT` ,
  `g11maleARTS_IP` ,
  `g11femaleARTS_IP` ,
  `g11ARTS_TOT_IP` ,
  `g11maleARTS_MUSLIM` ,
  `g11femaleARTS_MUSLIM` ,
  `g11ARTS_TOT_MUSLIM` ,
  `g11maleARTS_REP` ,
  `g11femaleARTS_REP` ,
  `g11ARTS_TOT_REP` ,
  `g11maleARTS_TRPUBLIC` ,
  `g11femaleARTS_TRPUBLIC` ,
  `g11ARTS_TOT_TRPUBLIC` ,
  `g11maleARTS_TRPRIVATE` ,
  `g11femaleARTS_TRPRIVATE` ,
  `g11ARTS_TOT_TRPRIVATE` ,
  `g11_ARTS_TOT_CLASS` ,
  `g11maleTVL_EN` ,
  `g11femaleTVL_EN` ,
  `g11TVL_TOT_EN` ,
  `g11maleTVL_BA` ,
  `g11femaleTVL_BA` ,
  `g11TVL_TOT_BA` ,
  `g11maleTVL_CCT` ,
  `g11femaleTVL_CCT` ,
  `g11TVL_TOT_CCT` ,
  `g11maleTVL_IP` ,
  `g11femaleTVL_IP` ,
  `g11TVL_TOT_IP` ,
  `g11maleTVL_MUSLIM` ,
  `g11femaleTVL_MUSLIM` ,
  `g11TVL_TOT_MUSLIM` ,
  `g11maleTVL_REP` ,
  `g11femaleTVL_REP` ,
  `g11TVL_TOT_REP` ,
  `g11maleTVL_TRPUBLIC` ,
  `g11femaleTVL_TRPUBLIC` ,
  `g11TVL_TOT_TRPUBLIC` ,
  `g11maleTVL_TRPRIVATE` ,
  `g11femaleTVL_TRPRIVATE` ,
  `g11TVL_TOT_TRPRIVATE` ,
  `g11_TVL_TOT_CLASS` ,
  `g11maleSPORTS_EN` ,
  `g11femaleSPORTS_EN` ,
  `g11SPORTS_TOT_EN` ,
  `g11maleSPORTS_BA` ,
  `g11femaleSPORTS_BA` ,
  `g11SPORTS_TOT_BA` ,
  `g11maleSPORTS_CCT` ,
  `g11femaleSPORTS_CCT` ,
  `g11SPORTS_TOT_CCT` ,
  `g11maleSPORTS_IP` ,
  `g11femaleSPORTS_IP` ,
  `g11SPORTS_TOT_IP` ,
  `g11maleSPORTS_MUSLIM` ,
  `g11femaleSPORTS_MUSLIM` ,
  `g11SPORTS_TOT_MUSLIM` ,
  `g11maleSPORTS_REP` ,
  `g11femaleSPORTS_REP` ,
  `g11SPORTS_TOT_REP` ,
  `g11maleSPORTS_TRPUBLIC` ,
  `g11femaleSPORTS_TRPUBLIC` ,
  `g11SPORTS_TOT_TRPUBLIC` ,
  `g11maleSPORTS_TRPRIVATE` ,
  `g11femaleSPORTS_TRPRIVATE` ,
  `g11SPORTS_TOT_TRPRIVATE` ,
  `g11_SPORTS_TOT_CLASS` ,
  `g11male_TOT_EN` ,
  `g11female_TOT_EN` ,
  `g11_TOT_EN` ,
  `g11male_TOT_BA` ,
  `g11female_TOT_BA` ,
  `g11_TOT_BA` ,
  `g11male_TOT_CCT` ,
  `g11female_TOT_CCT` ,
  `g11_TOT_CCT` ,
  `g11male_TOT_IP` ,
  `g11female_TOT_IP` ,
  `g11_TOT_IP` ,
  `g11male_TOT_MUSLIM` ,
  `g11female_TOT_MUSLIM` ,
  `g11_TOT_MUSLIM` ,
  `g11male_TOT_REP` ,
  `g11female_TOT_REP` ,
  `g11_TOT_REP` ,
  `g11male_TOT_TRPUBLIC` ,
  `g11female_TOT_TRPUBLIC` ,
  `g11_TOT_TRPUBLIC` ,
  `g11male_TOT_TRPRIVATE` ,
  `g11female_TOT_TRPRIVATE` ,
  `g11_TOT_TRPRIVATE` ,
  `g11_TOT_CLASS` ,
  `g12maleACAD_EN` ,
  `g12femaleACAD_EN` ,
  `g12ACAD_TOT_EN` ,
  `g12maleACAD_BA` ,
  `g12femaleACAD_BA` ,
  `g12ACAD_TOT_BA` ,
  `g12maleACAD_CCT` ,
  `g12femaleACAD_CCT` ,
  `g12ACAD_TOT_CCT` ,
  `g12maleACAD_IP` ,
  `g12femaleACAD_IP` ,
  `g12ACAD_TOT_IP` ,
  `g12maleACAD_MUSLIM` ,
  `g12femaleACAD_MUSLIM` ,
  `g12ACAD_TOT_MUSLIM` ,
  `g12maleACAD_REP` ,
  `g12femaleACAD_REP` ,
  `g12ACAD_TOT_REP` ,
  `g12maleACAD_TRPUBLIC` ,
  `g12femaleACAD_TRPUBLIC` ,
  `g12ACAD_TOT_TRPUBLIC` ,
  `g12maleACAD_TRPRIVATE` ,
  `g12femaleACAD_TRPRIVATE` ,
  `g12ACAD_TOT_TRPRIVATE` ,
  `g12_ACAD_TOT_CLASS` ,
  `g12maleARTS_EN` ,
  `g12femaleARTS_EN` ,
  `g12ARTS_TOT_EN` ,
  `g12maleARTS_BA` ,
  `g12femaleARTS_BA` ,
  `g12ARTS_TOT_BA` ,
  `g12maleARTS_CCT` ,
  `g12femaleARTS_CCT` ,
  `g12ARTS_TOT_CCT` ,
  `g12maleARTS_IP` ,
  `g12femaleARTS_IP` ,
  `g12ARTS_TOT_IP` ,
  `g12maleARTS_MUSLIM` ,
  `g12femaleARTS_MUSLIM` ,
  `g12ARTS_TOT_MUSLIM` ,
  `g12maleARTS_REP` ,
  `g12femaleARTS_REP` ,
  `g12ARTS_TOT_REP` ,
  `g12maleARTS_TRPUBLIC` ,
  `g12femaleARTS_TRPUBLIC` ,
  `g12ARTS_TOT_TRPUBLIC` ,
  `g12maleARTS_TRPRIVATE` ,
  `g12femaleARTS_TRPRIVATE` ,
  `g12ARTS_TOT_TRPRIVATE` ,
  `g12_ARTS_TOT_CLASS` ,
  `g12maleTVL_EN` ,
  `g12femaleTVL_EN` ,
  `g12TVL_TOT_EN` ,
  `g12maleTVL_BA` ,
  `g12femaleTVL_BA` ,
  `g12TVL_TOT_BA` ,
  `g12maleTVL_CCT` ,
  `g12femaleTVL_CCT` ,
  `g12TVL_TOT_CCT` ,
  `g12maleTVL_IP` ,
  `g12femaleTVL_IP` ,
  `g12TVL_TOT_IP` ,
  `g12maleTVL_MUSLIM` ,
  `g12femaleTVL_MUSLIM` ,
  `g12TVL_TOT_MUSLIM` ,
  `g12maleTVL_REP` ,
  `g12femaleTVL_REP` ,
  `g12TVL_TOT_REP` ,
  `g12maleTVL_TRPUBLIC` ,
  `g12femaleTVL_TRPUBLIC` ,
  `g12TVL_TOT_TRPUBLIC` ,
  `g12maleTVL_TRPRIVATE` ,
  `g12femaleTVL_TRPRIVATE` ,
  `g12TVL_TOT_TRPRIVATE` ,
  `g12_TVL_TOT_CLASS` ,
  `g12maleSPORTS_EN` ,
  `g12femaleSPORTS_EN` ,
  `g12SPORTS_TOT_EN` ,
  `g12maleSPORTS_BA` ,
  `g12femaleSPORTS_BA` ,
  `g12SPORTS_TOT_BA` ,
  `g12maleSPORTS_CCT` ,
  `g12femaleSPORTS_CCT` ,
  `g12SPORTS_TOT_CCT` ,
  `g12maleSPORTS_IP` ,
  `g12femaleSPORTS_IP` ,
  `g12SPORTS_TOT_IP` ,
  `g12maleSPORTS_MUSLIM` ,
  `g12femaleSPORTS_MUSLIM` ,
  `g12SPORTS_TOT_MUSLIM` ,
  `g12maleSPORTS_REP` ,
  `g12femaleSPORTS_REP` ,
  `g12SPORTS_TOT_REP` ,
  `g12maleSPORTS_TRPUBLIC` ,
  `g12femaleSPORTS_TRPUBLIC` ,
  `g12SPORTS_TOT_TRPUBLIC` ,
  `g12maleSPORTS_TRPRIVATE` ,
  `g12femaleSPORTS_TRPRIVATE` ,
  `g12SPORTS_TOT_TRPRIVATE` ,
  `g12_SPORTS_TOT_CLASS` ,
  `g12male_TOT_EN` ,
  `g12female_TOT_EN` ,
  `g12_TOT_EN` ,
  `g12male_TOT_BA` ,
  `g12female_TOT_BA` ,
  `g12_TOT_BA` ,
  `g12male_TOT_CCT` ,
  `g12female_TOT_CCT` ,
  `g12_TOT_CCT` ,
  `g12male_TOT_IP` ,
  `g12female_TOT_IP` ,
  `g12_TOT_IP` ,
  `g12male_TOT_MUSLIM` ,
  `g12female_TOT_MUSLIM` ,
  `g12_TOT_MUSLIM` ,
  `g12male_TOT_REP` ,
  `g12female_TOT_REP` ,
  `g12_TOT_REP` ,
  `g12male_TOT_TRPUBLIC` ,
  `g12female_TOT_TRPUBLIC` ,
  `g12_TOT_TRPUBLIC` ,
  `g12male_TOT_TRPRIVATE` ,
  `g12female_TOT_TRPRIVATE` ,
  `g12_TOT_TRPRIVATE` ,
  `g12_TOT_CLASS` ,
  `g11male_GAS` ,
  `g11female_GAS` ,
  `g11_TOT_GAS` ,
  `g11male_ABM` ,
  `g11female_ABM` ,
  `g11_TOT_ABM` ,
  `g11male_STEM` ,
  `g11female_STEM` ,
  `g11_TOT_STEM` ,
  `g11male_HSSS` ,
  `g11female_HSSS` ,
  `g11_TOT_HSSS` ,
  `g11male_TVL` ,
  `g11female_TVL` ,
  `g11_TOT_TVL` ,
  `g11male_ARTS` ,
  `g11female_ARTS` ,
  `g11_TOT_ARTS` ,
  `g11male_SPORTS` ,
  `g11female_SPORTS` ,
  `g11_TOT_SPORTS` ,
  `g11male_TOT` ,
  `g11female_TOT` ,
  `g11_TOT` ,
  `g12male_GAS` ,
  `g12female_GAS` ,
  `g12_TOT_GAS` ,
  `g12male_ABM` ,
  `g12female_ABM` ,
  `g12_TOT_ABM` ,
  `g12male_STEM` ,
  `g12female_STEM` ,
  `g12_TOT_STEM` ,
  `g12male_HSSS` ,
  `g12female_HSSS` ,
  `g12_TOT_HSSS` ,
  `g12male_TVL` ,
  `g12female_TVL` ,
  `g12_TOT_TVL` ,
  `g12male_ARTS` ,
  `g12female_ARTS` ,
  `g12_TOT_ARTS` ,
  `g12male_SPORTS` ,
  `g12female_SPORTS` ,
  `g12_TOT_SPORTS` ,
  `g12male_TOT` ,
  `g12female_TOT` ,
  `g12_TOT` )



SELECT sph.sy_from,

sph.school_id, 
-- ACAD
@g11maleACAD_EN:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id
               left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=497 and RCS_indi.id=25
) as g11maleACAD_EN,
@g11femaleACAD_EN:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=497 and RCS_indi.id=25
) as g11femaleACAD_EN,
(
               FLOOR(@g11maleACAD_EN+@g11femaleACAD_EN)
) as g11ACAD_TOT_EN,
 
@g11maleACAD_BA:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=497 and RCS_indi.id=312
) as g11maleACAD_BA,
@g11femaleACAD_BA:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=497 and RCS_indi.id=312
) as g11femaleACAD_BA,
(
               FLOOR(@g11maleACAD_BA+@g11femaleACAD_BA)
) as g11ACAD_TOT_BA,
 
@g11maleACAD_CCT:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=497 and RCS_indi.id=388
) as g11maleACAD_CCT,
@g11femaleACAD_CCT:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=497 and RCS_indi.id=388
) as g11femaleACAD_CCT,
(
               FLOOR(@g11maleACAD_CCT+@g11femaleACAD_CCT)
) as g11ACAD_TOT_CCT,
 
@g11maleACAD_IP:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=497 and RCS_indi.id=315
) as g11maleACAD_IP,
@g11femaleACAD_IP:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=497 and RCS_indi.id=315
) as g11femaleACAD_IP,
(
               FLOOR(@g11maleACAD_IP+@g11femaleACAD_IP)
) as g11ACAD_TOT_IP,
 
@g11maleACAD_MUSLIM:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=497 and RCS_indi.id=313
) as g11maleACAD_MUSLIM,
@g11femaleACAD_MUSLIM:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=497 and RCS_indi.id=313
) as g11femaleACAD_MUSLIM,
(
               FLOOR(@g11maleACAD_MUSLIM+@g11femaleACAD_MUSLIM)
) as g11ACAD_TOT_MUSLIM,

@g11maleACAD_REP:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=497 and RCS_indi.id=310
) as g11maleACAD_REP,
@g11femaleACAD_REP:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=497 and RCS_indi.id=310
) as g11femaleACAD_REP,
(
               FLOOR(@g11maleACAD_REP+@g11femaleACAD_REP)
) as g11ACAD_TOT_REP,
 
@g11maleACAD_TRPUBLIC:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=497 and RCS_indi.id=437
) as g11maleACAD_TRPUBLIC,
@g11femaleACAD_TRPUBLIC:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=497 and RCS_indi.id=437
) as g11femaleACAD_TRPUBLIC,
(
               FLOOR(@g11maleACAD_TRPUBLIC+@g11femaleACAD_TRPUBLIC)
) as g11ACAD_TOT_TRPUBLIC,
 
@g11maleACAD_TRPRIVATE:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=497 and RCS_indi.id=438
) as g11maleACAD_TRPRIVATE,
@g11femaleACAD_TRPRIVATE:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=497 and RCS_indi.id=438
) as g11femaleACAD_TRPRIVATE,
(
               FLOOR(@g11maleACAD_TRPRIVATE+@g11femaleACAD_TRPRIVATE)
) as g11ACAD_TOT_TRPRIVATE,
(
               select IFNULL(SUM(SES.class),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497
) as g11_ACAD_TOT_CLASS,
 
 
-- ARTS

@g11maleARTS_EN:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id
               left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=497 and RCS_indi.id=25
) as g11maleARTS_EN,
@g11femaleARTS_EN:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=497 and RCS_indi.id=25
) as g11femaleARTS_EN,
(
               FLOOR(@g11maleARTS_EN+@g11femaleARTS_EN)
) as g11ARTS_TOT_EN,
 
@g11maleARTS_BA:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=497 and RCS_indi.id=312
) as g11maleARTS_BA,
@g11femaleARTS_BA:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=497 and RCS_indi.id=312
) as g11femaleARTS_BA,
(
               FLOOR(@g11maleARTS_BA+@g11femaleARTS_BA)
) as g11ARTS_TOT_BA,
 
@g11maleARTS_CCT:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=497 and RCS_indi.id=388
) as g11maleARTS_CCT,
@g11femaleARTS_CCT:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=497 and RCS_indi.id=388
) as g11femaleARTS_CCT,
(
               FLOOR(@g11maleARTS_CCT+@g11femaleARTS_CCT)
) as g11ARTS_TOT_CCT,
 
@g11maleARTS_IP:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=497 and RCS_indi.id=315
) as g11maleARTS_IP,
@g11femaleARTS_IP:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=497 and RCS_indi.id=315
) as g11femaleARTS_IP,
(
               FLOOR(@g11maleARTS_IP+@g11femaleARTS_IP)
) as g11ARTS_TOT_IP,
 
@g11maleARTS_MUSLIM:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=497 and RCS_indi.id=313
) as g11maleARTS_MUSLIM,
@g11femaleARTS_MUSLIM:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=497 and RCS_indi.id=313
) as g11femaleARTS_MUSLIM,
(
               FLOOR(@g11maleARTS_MUSLIM+@g11femaleARTS_MUSLIM)
) as g11ARTS_TOT_MUSLIM,

@g11maleARTS_REP:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=497 and RCS_indi.id=310
) as g11maleARTS_REP,
@g11femaleARTS_REP:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=497 and RCS_indi.id=310
) as g11femaleARTS_REP,
(
               FLOOR(@g11maleARTS_REP+@g11femaleARTS_REP)
) as g11ARTS_TOT_REP,
 
@g11maleARTS_TRPUBLIC:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=497 and RCS_indi.id=437
) as g11maleARTS_TRPUBLIC,
@g11femaleARTS_TRPUBLIC:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=497 and RCS_indi.id=437
) as g11femaleARTS_TRPUBLIC,
(
               FLOOR(@g11maleARTS_TRPUBLIC+@g11femaleARTS_TRPUBLIC)
) as g11ARTS_TOT_TRPUBLIC,
 
@g11maleARTS_TRPRIVATE:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=497 and RCS_indi.id=438
) as g11maleARTS_TRPRIVATE,
@g11femaleARTS_TRPRIVATE:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=497 and RCS_indi.id=438
) as g11femaleARTS_TRPRIVATE,
(
               FLOOR(@g11maleARTS_TRPRIVATE+@g11femaleARTS_TRPRIVATE)
) as g11ARTS_TOT_TRPRIVATE,
(
               select IFNULL(SUM(SES.class),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497
) as g11_ARTS_TOT_CLASS,

 
 -- TVL
 
 @g11maleTVL_EN:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id
               left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=497 and RCS_indi.id=25
) as g11maleTVL_EN,
@g11femaleTVL_EN:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=497 and RCS_indi.id=25
) as g11femaleTVL_EN,
(
               FLOOR(@g11maleTVL_EN+@g11femaleTVL_EN)
) as g11TVL_TOT_EN,
 
@g11maleTVL_BA:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=497 and RCS_indi.id=312
) as g11maleTVL_BA,
@g11femaleTVL_BA:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=497 and RCS_indi.id=312
) as g11femaleTVL_BA,
(
               FLOOR(@g11maleTVL_BA+@g11femaleTVL_BA)
) as g11TVL_TOT_BA,
 
@g11maleTVL_CCT:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=497 and RCS_indi.id=388
) as g11maleTVL_CCT,
@g11femaleTVL_CCT:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=497 and RCS_indi.id=388
) as g11femaleTVL_CCT,
(
               FLOOR(@g11maleTVL_CCT+@g11femaleTVL_CCT)
) as g11TVL_TOT_CCT,
 
@g11maleTVL_IP:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=497 and RCS_indi.id=315
) as g11maleTVL_IP,
@g11femaleTVL_IP:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=497 and RCS_indi.id=315
) as g11femaleTVL_IP,
(
               FLOOR(@g11maleTVL_IP+@g11femaleTVL_IP)
) as g11TVL_TOT_IP,
 
@g11maleTVL_MUSLIM:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=497 and RCS_indi.id=313
) as g11maleTVL_MUSLIM,
@g11femaleTVL_MUSLIM:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=497 and RCS_indi.id=313
) as g11femaleTVL_MUSLIM,
(
               FLOOR(@g11maleTVL_MUSLIM+@g11femaleTVL_MUSLIM)
) as g11TVL_TOT_MUSLIM,

@g11maleTVL_REP:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=497 and RCS_indi.id=310
) as g11maleTVL_REP,
@g11femaleTVL_REP:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=497 and RCS_indi.id=310
) as g11femaleTVL_REP,
(
               FLOOR(@g11maleTVL_REP+@g11femaleTVL_REP)
) as g11TVL_TOT_REP,
 
@g11maleTVL_TRPUBLIC:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=497 and RCS_indi.id=437
) as g11maleTVL_TRPUBLIC,
@g11femaleTVL_TRPUBLIC:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=497 and RCS_indi.id=437
) as g11femaleTVL_TRPUBLIC,
(
               FLOOR(@g11maleTVL_TRPUBLIC+@g11femaleTVL_TRPUBLIC)
) as g11TVL_TOT_TRPUBLIC,
 
@g11maleTVL_TRPRIVATE:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=497 and RCS_indi.id=438
) as g11maleTVL_TRPRIVATE,
@g11femaleTVL_TRPRIVATE:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=497 and RCS_indi.id=438
) as g11femaleTVL_TRPRIVATE,
(
               FLOOR(@g11maleTVL_TRPRIVATE+@g11femaleTVL_TRPRIVATE)
) as g11TVL_TOT_TRPRIVATE,
(
               select IFNULL(SUM(SES.class),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497
) as g11_TVL_TOT_CLASS,


-- SPORTS

@g11maleSPORTS_EN:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id
               left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=497 and RCS_indi.id=25
) as g11maleSPORTS_EN,
@g11femaleSPORTS_EN:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=497 and RCS_indi.id=25
) as g11femaleSPORTS_EN,
(
               FLOOR(@g11maleSPORTS_EN+@g11femaleSPORTS_EN)
) as g11SPORTS_TOT_EN,
 
@g11maleSPORTS_BA:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=497 and RCS_indi.id=312
) as g11maleSPORTS_BA,
@g11femaleSPORTS_BA:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=497 and RCS_indi.id=312
) as g11femaleSPORTS_BA,
(
               FLOOR(@g11maleSPORTS_BA+@g11femaleSPORTS_BA)
) as g11SPORTS_TOT_BA,
 
@g11maleSPORTS_CCT:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=497 and RCS_indi.id=388
) as g11maleSPORTS_CCT,
@g11femaleSPORTS_CCT:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=497 and RCS_indi.id=388
) as g11femaleSPORTS_CCT,
(
               FLOOR(@g11maleSPORTS_CCT+@g11femaleSPORTS_CCT)
) as g11SPORTS_TOT_CCT,
 
@g11maleSPORTS_IP:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=497 and RCS_indi.id=315
) as g11maleSPORTS_IP,
@g11femaleSPORTS_IP:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=497 and RCS_indi.id=315
) as g11femaleSPORTS_IP,
(
               FLOOR(@g11maleSPORTS_IP+@g11femaleSPORTS_IP)
) as g11SPORTS_TOT_IP,
 
@g11maleSPORTS_MUSLIM:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=497 and RCS_indi.id=313
) as g11maleSPORTS_MUSLIM,
@g11femaleSPORTS_MUSLIM:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=497 and RCS_indi.id=313
) as g11femaleSPORTS_MUSLIM,
(
               FLOOR(@g11maleSPORTS_MUSLIM+@g11femaleSPORTS_MUSLIM)
) as g11SPORTS_TOT_MUSLIM,

@g11maleSPORTS_REP:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=497 and RCS_indi.id=310
) as g11maleSPORTS_REP,
@g11femaleSPORTS_REP:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=497 and RCS_indi.id=310
) as g11femaleSPORTS_REP,
(
               FLOOR(@g11maleSPORTS_REP+@g11femaleSPORTS_REP)
) as g11SPORTS_TOT_REP,
 
@g11maleSPORTS_TRPUBLIC:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=497 and RCS_indi.id=437
) as g11maleSPORTS_TRPUBLIC,
@g11femaleSPORTS_TRPUBLIC:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=497 and RCS_indi.id=437
) as g11femaleSPORTS_TRPUBLIC,
(
               FLOOR(@g11maleSPORTS_TRPUBLIC+@g11femaleSPORTS_TRPUBLIC)
) as g11SPORTS_TOT_TRPUBLIC,
 
@g11maleSPORTS_TRPRIVATE:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=497 and RCS_indi.id=438
) as g11maleSPORTS_TRPRIVATE,
@g11femaleSPORTS_TRPRIVATE:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=497 and RCS_indi.id=438
) as g11femaleSPORTS_TRPRIVATE,
(
               FLOOR(@g11maleSPORTS_TRPRIVATE+@g11femaleSPORTS_TRPRIVATE)
) as g11SPORTS_TOT_TRPRIVATE,
(
               select IFNULL(SUM(SES.class),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497
) as g11_SPORTS_TOT_CLASS,

-- TOTALS

@g11male_TOT_EN:=
(
	select IFNULL(SUM(SES.male),0) from ebeisdb.shs_enrolment_summary 
SES left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497 and RCS_indi.id=438
) as g11male_TOT_EN,
@g11female_TOT_EN:=
(
	select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497 and RCS_indi.id=438
) as g11female_TOT_EN,
(
	FLOOR(@g11male_TOT_EN+@g11female_TOT_EN)
) as g11_TOT_EN,


@g11male_TOT_BA:=
(
	select IFNULL(SUM(SES.male),0) from ebeisdb.shs_enrolment_summary 
SES left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497 and RCS_indi.id=312
) as g11male_TOT_BA,
@g11female_TOT_BA:=
(
	select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497 and RCS_indi.id=312
) as g11female_TOT_BA,
(
	FLOOR(@g11male_TOT_BA+@g11female_TOT_BA)
) as g11_TOT_BA,

@g11male_TOT_CCT:=
(
	select IFNULL(SUM(SES.male),0) from ebeisdb.shs_enrolment_summary 
SES left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497 and RCS_indi.id=388
) as g11male_TOT_CCT,
@g11female_TOT_CCT:=
(
	select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497 and RCS_indi.id=388
) as g11female_TOT_CCT,
(
	FLOOR(@g11male_TOT_CCT+@g11female_TOT_CCT)
) as g11_TOT_CCT,
@g11male_TOT_IP:=
(
	select IFNULL(SUM(SES.male),0) from ebeisdb.shs_enrolment_summary 
SES left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497 and RCS_indi.id=315
) as g11male_TOT_IP,
@g11female_TOT_IP:=
(
	select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497 and RCS_indi.id=315
) as g11female_TOT_IP,
(
	FLOOR(@g11male_TOT_IP+@g11female_TOT_IP)
) as g11_TOT_IP,

@g11male_TOT_MUSLIM:=
(
	select IFNULL(SUM(SES.male),0) from ebeisdb.shs_enrolment_summary 
SES left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497 and RCS_indi.id=313
) as g11male_TOT_MUSLIM,
@g11female_TOT_MUSLIM:=
(
	select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497 and RCS_indi.id=313
) as g11female_TOT_MUSLIM,
(
	FLOOR(@g11male_TOT_MUSLIM+@g11female_TOT_MUSLIM)
) as g11_TOT_MUSLIM,
@g11male_TOT_REP:=
(
	select IFNULL(SUM(SES.male),0) from ebeisdb.shs_enrolment_summary 
SES left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497 and RCS_indi.id=310
) as g11male_TOT_REP,
@g11female_TOT_REP:=
(
	select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497 and RCS_indi.id=310
) as g11female_TOT_REP,
(
	FLOOR(@g11male_TOT_REP+@g11female_TOT_REP)
) as g11_TOT_REP,
@g11male_TOT_TRPUBLIC:=
(
	select IFNULL(SUM(SES.male),0) from ebeisdb.shs_enrolment_summary 
SES left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497 and RCS_indi.id=437
) as g11male_TOT_TRPUBLIC,
@g11female_TOT_TRPUBLIC:=
(
	select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497 and RCS_indi.id=437
) as g11female_TOT_TRPUBLIC,
(
	FLOOR(@g11male_TOT_TRPUBLIC+@g11female_TOT_TRPUBLIC)
) as g11_TOT_TRPUBLIC,
@g11male_TOT_TRPRIVATE:=
(
	select IFNULL(SUM(SES.male),0) from ebeisdb.shs_enrolment_summary 
SES left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497 and RCS_indi.id=438
) as g11male_TOT_TRPRIVATE,
@g11female_TOT_TRPRIVATE:=
(
	select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497 and RCS_indi.id=438
) as g11female_TOT_TRPRIVATE,
(
	FLOOR(@g11male_TOT_TRPRIVATE+@g11female_TOT_TRPRIVATE)
) as g11_TOT_TRPRIVATE,
(
               select IFNULL(SUM(SES.class),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id
) as g11_TOT_CLASS,


-- GRADE 12 ---



-- ACAD
@g12maleACAD_EN:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id
               left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=595 and RCS_indi.id=25
) as g12maleACAD_EN,
@g12femaleACAD_EN:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=595 and RCS_indi.id=25
) as g12femaleACAD_EN,
(
               FLOOR(@g12maleACAD_EN+@g12femaleACAD_EN)
) as g12ACAD_TOT_EN,
 
@g12maleACAD_BA:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=595 and RCS_indi.id=312
) as g12maleACAD_BA,
@g12femaleACAD_BA:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=595 and RCS_indi.id=312
) as g12femaleACAD_BA,
(
               FLOOR(@g12maleACAD_BA+@g12femaleACAD_BA)
) as g12ACAD_TOT_BA,
 
@g12maleACAD_CCT:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=595 and RCS_indi.id=388
) as g12maleACAD_CCT,
@g12femaleACAD_CCT:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=595 and RCS_indi.id=388
) as g12femaleACAD_CCT,
(
               FLOOR(@g12maleACAD_CCT+@g12femaleACAD_CCT)
) as g12ACAD_TOT_CCT,
 
@g12maleACAD_IP:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=595 and RCS_indi.id=315
) as g12maleACAD_IP,
@g12femaleACAD_IP:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=595 and RCS_indi.id=315
) as g12femaleACAD_IP,
(
               FLOOR(@g12maleACAD_IP+@g12femaleACAD_IP)
) as g12ACAD_TOT_IP,
 
@g12maleACAD_MUSLIM:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=595 and RCS_indi.id=313
) as g12maleACAD_MUSLIM,
@g12femaleACAD_MUSLIM:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=595 and RCS_indi.id=313
) as g12femaleACAD_MUSLIM,
(
               FLOOR(@g12maleACAD_MUSLIM+@g12femaleACAD_MUSLIM)
) as g12ACAD_TOT_MUSLIM,

@g12maleACAD_REP:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=595 and RCS_indi.id=310
) as g12maleACAD_REP,
@g12femaleACAD_REP:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=595 and RCS_indi.id=310
) as g12femaleACAD_REP,
(
               FLOOR(@g12maleACAD_REP+@g12femaleACAD_REP)
) as g12ACAD_TOT_REP,
 
@g12maleACAD_TRPUBLIC:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=595 and RCS_indi.id=437
) as g12maleACAD_TRPUBLIC,
@g12femaleACAD_TRPUBLIC:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=595 and RCS_indi.id=437
) as g12femaleACAD_TRPUBLIC,
(
               FLOOR(@g12maleACAD_TRPUBLIC+@g12femaleACAD_TRPUBLIC)
) as g12ACAD_TOT_TRPUBLIC,
 
@g12maleACAD_TRPRIVATE:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=595 and RCS_indi.id=438
) as g12maleACAD_TRPRIVATE,
@g12femaleACAD_TRPRIVATE:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=905 
and RCS_gradeLvl.id=595 and RCS_indi.id=438
) as g12femaleACAD_TRPRIVATE,
(
               FLOOR(@g12maleACAD_TRPRIVATE+@g12femaleACAD_TRPRIVATE)
) as g12ACAD_TOT_TRPRIVATE,
(
               select IFNULL(SUM(SES.class),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595
) as g12_ACAD_TOT_CLASS,
 
 
-- ARTS

@g12maleARTS_EN:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id
               left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=595 and RCS_indi.id=25
) as g12maleARTS_EN,
@g12femaleARTS_EN:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=595 and RCS_indi.id=25
) as g12femaleARTS_EN,
(
               FLOOR(@g12maleARTS_EN+@g12femaleARTS_EN)
) as g12ARTS_TOT_EN,
 
@g12maleARTS_BA:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=595 and RCS_indi.id=312
) as g12maleARTS_BA,
@g12femaleARTS_BA:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=595 and RCS_indi.id=312
) as g12femaleARTS_BA,
(
               FLOOR(@g12maleARTS_BA+@g12femaleARTS_BA)
) as g12ARTS_TOT_BA,
 
@g12maleARTS_CCT:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=595 and RCS_indi.id=388
) as g12maleARTS_CCT,
@g12femaleARTS_CCT:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=595 and RCS_indi.id=388
) as g12femaleARTS_CCT,
(
               FLOOR(@g12maleARTS_CCT+@g12femaleARTS_CCT)
) as g12ARTS_TOT_CCT,
 
@g12maleARTS_IP:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=595 and RCS_indi.id=315
) as g12maleARTS_IP,
@g12femaleARTS_IP:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=595 and RCS_indi.id=315
) as g12femaleARTS_IP,
(
               FLOOR(@g12maleARTS_IP+@g12femaleARTS_IP)
) as g12ARTS_TOT_IP,
 
@g12maleARTS_MUSLIM:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=595 and RCS_indi.id=313
) as g12maleARTS_MUSLIM,
@g12femaleARTS_MUSLIM:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=595 and RCS_indi.id=313
) as g12femaleARTS_MUSLIM,
(
               FLOOR(@g12maleARTS_MUSLIM+@g12femaleARTS_MUSLIM)
) as g12ARTS_TOT_MUSLIM,

@g12maleARTS_REP:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=595 and RCS_indi.id=310
) as g12maleARTS_REP,
@g12femaleARTS_REP:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=595 and RCS_indi.id=310
) as g12femaleARTS_REP,
(
               FLOOR(@g12maleARTS_REP+@g12femaleARTS_REP)
) as g12ARTS_TOT_REP,
 
@g12maleARTS_TRPUBLIC:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=595 and RCS_indi.id=437
) as g12maleARTS_TRPUBLIC,
@g12femaleARTS_TRPUBLIC:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=595 and RCS_indi.id=437
) as g12femaleARTS_TRPUBLIC,
(
               FLOOR(@g12maleARTS_TRPUBLIC+@g12femaleARTS_TRPUBLIC)
) as g12ARTS_TOT_TRPUBLIC,
 
@g12maleARTS_TRPRIVATE:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=595 and RCS_indi.id=438
) as g12maleARTS_TRPRIVATE,
@g12femaleARTS_TRPRIVATE:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=595 and RCS_indi.id=438
) as g12femaleARTS_TRPRIVATE,
(
               FLOOR(@g12maleARTS_TRPRIVATE+@g12femaleARTS_TRPRIVATE)
) as g12ARTS_TOT_TRPRIVATE,
(
               select IFNULL(SUM(SES.class),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595
) as g12_ARTS_TOT_CLASS,

 
 -- TVL
 
 @g12maleTVL_EN:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id
               left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=595 and RCS_indi.id=25
) as g12maleTVL_EN,
@g12femaleTVL_EN:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=595 and RCS_indi.id=25
) as g12femaleTVL_EN,
(
               FLOOR(@g12maleTVL_EN+@g12femaleTVL_EN)
) as g12TVL_TOT_EN,
 
@g12maleTVL_BA:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=595 and RCS_indi.id=312
) as g12maleTVL_BA,
@g12femaleTVL_BA:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=595 and RCS_indi.id=312
) as g12femaleTVL_BA,
(
               FLOOR(@g12maleTVL_BA+@g12femaleTVL_BA)
) as g12TVL_TOT_BA,
 
@g12maleTVL_CCT:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=595 and RCS_indi.id=388
) as g12maleTVL_CCT,
@g12femaleTVL_CCT:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=595 and RCS_indi.id=388
) as g12femaleTVL_CCT,
(
               FLOOR(@g12maleTVL_CCT+@g12femaleTVL_CCT)
) as g12TVL_TOT_CCT,
 
@g12maleTVL_IP:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=595 and RCS_indi.id=315
) as g12maleTVL_IP,
@g12femaleTVL_IP:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=595 and RCS_indi.id=315
) as g12femaleTVL_IP,
(
               FLOOR(@g12maleTVL_IP+@g12femaleTVL_IP)
) as g12TVL_TOT_IP,
 
@g12maleTVL_MUSLIM:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=595 and RCS_indi.id=313
) as g12maleTVL_MUSLIM,
@g12femaleTVL_MUSLIM:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=595 and RCS_indi.id=313
) as g12femaleTVL_MUSLIM,
(
               FLOOR(@g12maleTVL_MUSLIM+@g12femaleTVL_MUSLIM)
) as g12TVL_TOT_MUSLIM,

@g12maleTVL_REP:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=595 and RCS_indi.id=310
) as g12maleTVL_REP,
@g12femaleTVL_REP:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=595 and RCS_indi.id=310
) as g12femaleTVL_REP,
(
               FLOOR(@g12maleTVL_REP+@g12femaleTVL_REP)
) as g12TVL_TOT_REP,
 
@g12maleTVL_TRPUBLIC:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=595 and RCS_indi.id=437
) as g12maleTVL_TRPUBLIC,
@g12femaleTVL_TRPUBLIC:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=595 and RCS_indi.id=437
) as g12femaleTVL_TRPUBLIC,
(
               FLOOR(@g12maleTVL_TRPUBLIC+@g12femaleTVL_TRPUBLIC)
) as g12TVL_TOT_TRPUBLIC,
 
@g12maleTVL_TRPRIVATE:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=595 and RCS_indi.id=438
) as g12maleTVL_TRPRIVATE,
@g12femaleTVL_TRPRIVATE:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=595 and RCS_indi.id=438
) as g12femaleTVL_TRPRIVATE,
(
               FLOOR(@g12maleTVL_TRPRIVATE+@g12femaleTVL_TRPRIVATE)
) as g12TVL_TOT_TRPRIVATE,
(
               select IFNULL(SUM(SES.class),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595
) as g12_TVL_TOT_CLASS,


-- SPORTS

@g12maleSPORTS_EN:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id
               left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=595 and RCS_indi.id=25
) as g12maleSPORTS_EN,
@g12femaleSPORTS_EN:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=595 and RCS_indi.id=25
) as g12femaleSPORTS_EN,
(
               FLOOR(@g12maleSPORTS_EN+@g12femaleSPORTS_EN)
) as g12SPORTS_TOT_EN,
 
@g12maleSPORTS_BA:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=595 and RCS_indi.id=312
) as g12maleSPORTS_BA,
@g12femaleSPORTS_BA:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=595 and RCS_indi.id=312
) as g12femaleSPORTS_BA,
(
               FLOOR(@g12maleSPORTS_BA+@g12femaleSPORTS_BA)
) as g12SPORTS_TOT_BA,
 
@g12maleSPORTS_CCT:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=595 and RCS_indi.id=388
) as g12maleSPORTS_CCT,
@g12femaleSPORTS_CCT:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=595 and RCS_indi.id=388
) as g12femaleSPORTS_CCT,
(
               FLOOR(@g12maleSPORTS_CCT+@g12femaleSPORTS_CCT)
) as g12SPORTS_TOT_CCT,
 
@g12maleSPORTS_IP:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=595 and RCS_indi.id=315
) as g12maleSPORTS_IP,
@g12femaleSPORTS_IP:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=595 and RCS_indi.id=315
) as g12femaleSPORTS_IP,
(
               FLOOR(@g12maleSPORTS_IP+@g12femaleSPORTS_IP)
) as g12SPORTS_TOT_IP,
 
@g12maleSPORTS_MUSLIM:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=595 and RCS_indi.id=313
) as g12maleSPORTS_MUSLIM,
@g12femaleSPORTS_MUSLIM:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=595 and RCS_indi.id=313
) as g12femaleSPORTS_MUSLIM,
(
               FLOOR(@g12maleSPORTS_MUSLIM+@g12femaleSPORTS_MUSLIM)
) as g12SPORTS_TOT_MUSLIM,

@g12maleSPORTS_REP:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=595 and RCS_indi.id=310
) as g12maleSPORTS_REP,
@g12femaleSPORTS_REP:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=595 and RCS_indi.id=310
) as g12femaleSPORTS_REP,
(
               FLOOR(@g12maleSPORTS_REP+@g12femaleSPORTS_REP)
) as g12SPORTS_TOT_REP,
 
@g12maleSPORTS_TRPUBLIC:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=595 and RCS_indi.id=437
) as g12maleSPORTS_TRPUBLIC,
@g12femaleSPORTS_TRPUBLIC:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=595 and RCS_indi.id=437
) as g12femaleSPORTS_TRPUBLIC,
(
               FLOOR(@g12maleSPORTS_TRPUBLIC+@g12femaleSPORTS_TRPUBLIC)
) as g12SPORTS_TOT_TRPUBLIC,
 
@g12maleSPORTS_TRPRIVATE:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=595 and RCS_indi.id=438
) as g12maleSPORTS_TRPRIVATE,
@g12femaleSPORTS_TRPRIVATE:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=595 and RCS_indi.id=438
) as g12femaleSPORTS_TRPRIVATE,
(
               FLOOR(@g12maleSPORTS_TRPRIVATE+@g12femaleSPORTS_TRPRIVATE)
) as g12SPORTS_TOT_TRPRIVATE,
(
               select IFNULL(SUM(SES.class),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595
) as g12_SPORTS_TOT_CLASS,

-- TOTALS

@g12male_TOT_EN:=
(
	select IFNULL(SUM(SES.male),0) from ebeisdb.shs_enrolment_summary 
SES left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595 and RCS_indi.id=438
) as g12male_TOT_EN,
@g12female_TOT_EN:=
(
	select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595 and RCS_indi.id=438
) as g12female_TOT_EN,
(
	FLOOR(@g12male_TOT_EN+@g12female_TOT_EN)
) as g12_TOT_EN,


@g12male_TOT_BA:=
(
	select IFNULL(SUM(SES.male),0) from ebeisdb.shs_enrolment_summary 
SES left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595 and RCS_indi.id=312
) as g12male_TOT_BA,
@g12female_TOT_BA:=
(
	select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595 and RCS_indi.id=312
) as g12female_TOT_BA,
(
	FLOOR(@g12male_TOT_BA+@g12female_TOT_BA)
) as g12_TOT_BA,

@g12male_TOT_CCT:=
(
	select IFNULL(SUM(SES.male),0) from ebeisdb.shs_enrolment_summary 
SES left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595 and RCS_indi.id=388
) as g12male_TOT_CCT,
@g12female_TOT_CCT:=
(
	select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595 and RCS_indi.id=388
) as g12female_TOT_CCT,
(
	FLOOR(@g12male_TOT_CCT+@g12female_TOT_CCT)
) as g12_TOT_CCT,
@g12male_TOT_IP:=
(
	select IFNULL(SUM(SES.male),0) from ebeisdb.shs_enrolment_summary 
SES left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595 and RCS_indi.id=315
) as g12male_TOT_IP,
@g12female_TOT_IP:=
(
	select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595 and RCS_indi.id=315
) as g12female_TOT_IP,
(
	FLOOR(@g12male_TOT_IP+@g12female_TOT_IP)
) as g12_TOT_IP,

@g12male_TOT_MUSLIM:=
(
	select IFNULL(SUM(SES.male),0) from ebeisdb.shs_enrolment_summary 
SES left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595 and RCS_indi.id=313
) as g12male_TOT_MUSLIM,
@g12female_TOT_MUSLIM:=
(
	select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595 and RCS_indi.id=313
) as g12female_TOT_MUSLIM,
(
	FLOOR(@g12male_TOT_MUSLIM+@g12female_TOT_MUSLIM)
) as g12_TOT_MUSLIM,
@g12male_TOT_REP:=
(
	select IFNULL(SUM(SES.male),0) from ebeisdb.shs_enrolment_summary 
SES left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595 and RCS_indi.id=310
) as g12male_TOT_REP,
@g12female_TOT_REP:=
(
	select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595 and RCS_indi.id=310
) as g12female_TOT_REP,
(
	FLOOR(@g12male_TOT_REP+@g12female_TOT_REP)
) as g12_TOT_REP,
@g12male_TOT_TRPUBLIC:=
(
	select IFNULL(SUM(SES.male),0) from ebeisdb.shs_enrolment_summary 
SES left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595 and RCS_indi.id=437
) as g12male_TOT_TRPUBLIC,
@g12female_TOT_TRPUBLIC:=
(
	select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595 and RCS_indi.id=437
) as g12female_TOT_TRPUBLIC,
(
	FLOOR(@g12male_TOT_TRPUBLIC+@g12female_TOT_TRPUBLIC)
) as g12_TOT_TRPUBLIC,
@g12male_TOT_TRPRIVATE:=
(
	select IFNULL(SUM(SES.male),0) from ebeisdb.shs_enrolment_summary 
SES left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595 and RCS_indi.id=438
) as g12male_TOT_TRPRIVATE,
@g12female_TOT_TRPRIVATE:=
(
	select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id 
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595 and RCS_indi.id=438
) as g12female_TOT_TRPRIVATE,
(
	FLOOR(@g12male_TOT_TRPRIVATE+@g12female_TOT_TRPRIVATE)
) as g12_TOT_TRPRIVATE,
(
               select IFNULL(SUM(SES.class),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id
) as g12_TOT_CLASS,






-- TABLE 4



@g11male_GAS:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               where SES.report_history_id = rh.id and  
SES.grade_level_id=497 and SO.shs_strand_id=4 and SO.shs_track_id=905 and 
SES.pupil_data_indicator=25
) as g11male_GAS,
@g11female_GAS:=(
                select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               where SES.report_history_id = rh.id and  
SES.grade_level_id=497 and SO.shs_strand_id=4 and SO.shs_track_id=905 and 
SES.pupil_data_indicator=25
) as g11female_GAS,
(
               FLOOR(@g11male_GAS+@g11female_GAS)
) as g11_TOT_GAS,
@g11male_ABM:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               where SES.report_history_id = rh.id and  
SES.grade_level_id=497 and SO.shs_strand_id=1 and SO.shs_track_id=905 and 
SES.pupil_data_indicator=25
) as g11male_ABM,
@g11female_ABM:=(
                select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               where SES.report_history_id = rh.id and  
SES.grade_level_id=497 and SO.shs_strand_id=1 and SO.shs_track_id=905 and 
SES.pupil_data_indicator=25
) as g11female_ABM,
(
               FLOOR(@g11male_ABM+@g11female_ABM)
) as g11_TOT_ABM,

@g11male_STEM:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               where SES.report_history_id = rh.id and  
SES.grade_level_id=497 and SO.shs_strand_id=3 and SO.shs_track_id=905 and 
SES.pupil_data_indicator=25
) as g11male_STEM,
@g11female_STEM:=(
                select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               where SES.report_history_id = rh.id and  
SES.grade_level_id=497 and SO.shs_strand_id=3 and SO.shs_track_id=905 and 
SES.pupil_data_indicator=25
) as g11female_STEM,
(
               FLOOR(@g11male_STEM+@g11female_STEM)
) as g11_TOT_STEM,
@g11male_HSSS:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               where SES.report_history_id = rh.id and  
SES.grade_level_id=497 and SO.shs_strand_id=2 and SO.shs_track_id=905 and 
SES.pupil_data_indicator=25
) as g11male_HSSS,
@g11female_HSSS:=(
                select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               where SES.report_history_id = rh.id and  
SES.grade_level_id=497 and SO.shs_strand_id=2 and SO.shs_track_id=905 and 
SES.pupil_data_indicator=25
) as g11female_HSSS,
(
               FLOOR(@g11male_HSSS+@g11female_HSSS)
) as g11_TOT_HSSS,
 @g11male_TVL:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id
               left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=497 and SES.pupil_data_indicator=25
) as g11male_TVL,
@g11female_TVL:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=497 and SES.pupil_data_indicator=25
) as g11female_TVL,
(
               FLOOR(@g11male_TVL+@g11female_TVL)
) as g11_TOT_TVL,

@g11male_ARTS:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id
               left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=497 and SES.pupil_data_indicator=25
) as g11male_ARTS,
@g11female_ARTS:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=497 and SES.pupil_data_indicator=25
) as g11female_ARTS,
(
               FLOOR(@g11male_ARTS+@g11female_ARTS)
) as g11_TOT_ARTS,
@g11male_SPORTS:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id
               left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=497 and SES.pupil_data_indicator=25
) as g11male_SPORTS,
@g11female_SPORTS:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=497 and SES.pupil_data_indicator=25
) as g11female_SPORTS,
(
               FLOOR(@g11male_SPORTS+@g11female_SPORTS)
) as g11_TOT_SPORTS,

@g11male_TOT:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id
               left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497 and SES.pupil_data_indicator=25
) as g11male_TOT,
@g11female_TOT:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=497 and SES.pupil_data_indicator=25
) as g11female_TOT,
(
               FLOOR(@g11male_TOT+@g11female_TOT)
) as g11_TOT,

@g12male_GAS:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               where SES.report_history_id = rh.id and  
SES.grade_level_id=595 and SO.shs_strand_id=4 and 
SES.pupil_data_indicator=25
) as g12male_GAS,
@g12female_GAS:=(
                select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               where SES.report_history_id = rh.id and  
SES.grade_level_id=595 and SO.shs_strand_id=4 and 
SES.pupil_data_indicator=25
) as g12female_GAS,
(
               FLOOR(@g12male_GAS+@g12female_GAS)
) as g12_TOT_GAS,
@g12male_ABM:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               where SES.report_history_id = rh.id and  
SES.grade_level_id=595 and SO.shs_strand_id=1 and 
SES.pupil_data_indicator=25
) as g12male_ABM,
@g12female_ABM:=(
                select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               where SES.report_history_id = rh.id and  
SES.grade_level_id=595 and SO.shs_strand_id=1 and 
SES.pupil_data_indicator=25
) as g12female_ABM,
(
               FLOOR(@g12male_ABM+@g12female_ABM)
) as g12_TOT_ABM,

@g12male_STEM:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               where SES.report_history_id = rh.id and  
SES.grade_level_id=595 and SO.shs_strand_id=3 and 
SES.pupil_data_indicator=25
) as g12male_STEM,
@g12female_STEM:=(
                select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               where SES.report_history_id = rh.id and  
SES.grade_level_id=595 and SO.shs_strand_id=3 and 
SES.pupil_data_indicator=25
) as g12female_STEM,
(
               FLOOR(@g12male_STEM+@g12female_STEM)
) as g12_TOT_STEM,
@g12male_HSSS:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               where SES.report_history_id = rh.id and  
SES.grade_level_id=595 and SO.shs_strand_id=2 and 
SES.pupil_data_indicator=25
) as g12male_HSSS,
@g12female_HSSS:=(
                select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               where SES.report_history_id = rh.id and  
SES.grade_level_id=595 and SO.shs_strand_id=2 and 
SES.pupil_data_indicator=25
) as g12female_HSSS,
(
               FLOOR(@g12male_HSSS+@g12female_HSSS)
) as g12_TOT_HSSS,
 @g12male_TVL:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id
               left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=595 and SES.pupil_data_indicator=25
) as g12male_TVL,
@g12female_TVL:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=906 
and RCS_gradeLvl.id=595 and SES.pupil_data_indicator=25
) as g12female_TVL,
(
               FLOOR(@g12male_TVL+@g12female_TVL)
) as g12_TOT_TVL,

@g12male_ARTS:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id
               left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=595 and SES.pupil_data_indicator=25
) as g12male_ARTS,
@g12female_ARTS:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=908 
and RCS_gradeLvl.id=595 and SES.pupil_data_indicator=25
) as g12female_ARTS,
(
               FLOOR(@g12male_ARTS+@g12female_ARTS)
) as g12_TOT_ARTS,
@g12male_SPORTS:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id
               left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=595 and SES.pupil_data_indicator=25
) as g12male_SPORTS,
@g12female_SPORTS:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and RCS_track.id=907 
and RCS_gradeLvl.id=595 and SES.pupil_data_indicator=25
) as g12female_SPORTS,
(
               FLOOR(@g12male_SPORTS+@g12female_SPORTS)
) as g12_TOT_SPORTS,

@g12male_TOT:=(
               select IFNULL(SUM(SES.male),0) from 
ebeisdb.shs_enrolment_summary SES 
               left join ebeisdb.shs_offerings SO on SES.shs_offerings_id=SO.id 
               left join ebeisdb.ref_code_setting RCS_track on SO.shs_track_id = 
RCS_track.id
               left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id
               left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595 and SES.pupil_data_indicator=25
) as g12male_TOT,
@g12female_TOT:=(
               select IFNULL(SUM(SES.female),0) from 
ebeisdb.shs_enrolment_summary SES left join ebeisdb.shs_offerings SO on 
SES.shs_offerings_id=SO.id left join ebeisdb.ref_code_setting RCS_track on 
SO.shs_track_id = RCS_track.id left join ebeisdb.ref_code_setting RCS_gradeLvl on 
SES.grade_level_id=RCS_gradeLvl.id left join ebeisdb.ref_code_setting RCS_indi on 
SES.pupil_data_indicator=RCS_indi.id
               where SES.report_history_id = rh.id and 
RCS_gradeLvl.id=595 and SES.pupil_data_indicator=25
) as g12female_TOT,
(
               FLOOR(@g12male_TOT+@g12female_TOT)
) as g12_TOT





FROM ebeisdb.school_profile_history sph
   LEFT JOIN ebeisdb.ref_region rr ON (rr.id=sph.region_id)
   LEFT JOIN (ebeisdb.report_history rh
                     inner join ebeisdb.ref_report_history rrh on 
rh.ref_report_history_id = rrh.id
                     inner join ebeisdb.ref_reports rrs on rrs.id  = 
rrh.report_id
                     inner join ebeisdb.ref_report_generics rrg on rrg.id 
= rrs.ref_report_generics_id and rrg.id=1
               ) on rh.school_id = sph.school_id and rh.sy_from= 
sph.sy_from and rh.report_status >= 297 -- cast( sph.sy_from as unsigned) 
 
               and rh.report_id in (7,8,9,33)
              
  
   WHERE  
   -- sph.take_part_id = 1 and 
   sph.sy_from = 2016 and 
   -- secondary only
   sph.co_gen_class=434 
   -- for senior highschool offering codes 
   and sph.curricular_class_id > 900 
   
   GROUP BY sph.SCHOOL_ID
   ORDER BY sph.SY_FROM, rr.RANK ASC, sph.SCHOOL_ID ASC;
